import{u as B,d as A,r as i,q as D,j as e,C as j}from"./index-DBCfkQ6B.js";import{C as l,a as f,b as u,d as c}from"./card-C9sEKIdK.js";import{B as L}from"./button-B6KX4ziW.js";import{I as E}from"./input-ujcKxSfi.js";import{B as n}from"./badge-CweJyfao.js";import{A as N,a as b}from"./alert-368Ze6hE.js";import{S as U}from"./share-2-CZJB5hhk.js";import{L as T}from"./link-DVV8IVhZ.js";import{C as x}from"./circle-check-big-E2gyd2JE.js";import{C as I}from"./copy-B4qOb-zK.js";import{G as F}from"./gift-C37HCUJ9.js";import{U as p}from"./users-C8hr7BhR.js";import{U as y}from"./user-plus-K7gLpsNK.js";import{C as G}from"./circle-x-Df7mIiIp.js";const _=()=>{const{user:a,profile:r}=B(),{toast:d}=A(),[t,w]=i.useState([]),[v,h]=i.useState(!0),[m,g]=i.useState(!1),o=r!=null&&r.referralCode?`${window.location.origin}/register?ref=${r.referralCode}`:"";i.useEffect(()=>{a&&(r!=null&&r.referralCode)&&C()},[a,r]);const C=async()=>{try{if(h(!0),a!=null&&a.uid){const s=await D.getReferralsByReferrerId(a.uid);w(s)}}catch(s){console.error("Error loading referrals:",s),d({title:"خطأ في تحميل الإحالات",description:"حدث خطأ أثناء تحميل قائمة الإحالات",variant:"destructive"})}finally{h(!1)}},k=async()=>{try{await navigator.clipboard.writeText(o),g(!0),d({title:"تم النسخ بنجاح",description:"تم نسخ رابط الإحالة إلى الحافظة"}),setTimeout(()=>g(!1),2e3)}catch{d({title:"خطأ في النسخ",description:"حدث خطأ أثناء نسخ الرابط",variant:"destructive"})}},S=s=>{switch(s){case"completed":return e.jsxs(n,{variant:"default",className:"bg-green-100 text-green-800 border-green-200",children:[e.jsx(x,{className:"w-3 h-3 mr-1"}),"مكتملة"]});case"pending":return e.jsxs(n,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),"قيد الانتظار"]});case"cancelled":return e.jsxs(n,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),"ملغية"]});default:return e.jsx(n,{variant:"outline",children:"غير محدد"})}},R=s=>s?(s.toDate?s.toDate():new Date(s)).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}):"غير محدد";return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-4",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"جاري تحميل الإحالات..."})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center justify-center gap-2",children:[e.jsx(U,{className:"h-8 w-8 text-green-600"}),"نظام الإحالات"]}),e.jsx("p",{className:"text-gray-600",children:"ادع أصدقاءك واحصل على مكافآت عند انضمامهم"})]}),e.jsxs(l,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:[e.jsx(f,{children:e.jsxs(u,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(T,{className:"h-5 w-5"}),"رابط الإحالة الخاص بك"]})}),e.jsx(c,{className:"space-y-4",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{value:o,readOnly:!0,className:"flex-1 bg-gray-50 border-gray-200"}),e.jsx(L,{onClick:k,variant:m?"default":"outline",className:m?"bg-green-600 hover:bg-green-700":"",children:m?e.jsx(x,{className:"h-4 w-4"}):e.jsx(I,{className:"h-4 w-4"})})]}),e.jsxs(N,{className:"border-green-200 bg-green-50",children:[e.jsx(F,{className:"h-4 w-4 text-green-600"}),e.jsx(b,{className:"text-green-700",children:"شارك هذا الرابط مع أصدقائك للحصول على مكافآت عند تسجيلهم"})]})]}):e.jsx(N,{variant:"destructive",children:e.jsx(b,{children:"لم يتم العثور على رمز الإحالة الخاص بك"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(l,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"إجمالي الإحالات"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),e.jsx(p,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(l,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"الإحالات المكتملة"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(s=>s.status==="completed").length})]}),e.jsx(x,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(l,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"قيد الانتظار"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.filter(s=>s.status==="pending").length})]}),e.jsx(j,{className:"h-8 w-8 text-yellow-600"})]})})})]}),e.jsxs(l,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:[e.jsx(f,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-green-600"}),"المستخدمون المحالون"]})}),e.jsx(c,{children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد إحالات بعد"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ابدأ بدعوة أصدقائك باستخدام رابط الإحالة أعلاه"})]}):e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-gray-50/50",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.referredUserEmail}),e.jsxs("p",{className:"text-sm text-gray-600",children:["تاريخ الإحالة: ",R(s.createdAt)]})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:S(s.status)})]},s.id))})})]})]})})};export{_ as default};
