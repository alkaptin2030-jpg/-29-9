import{c as q,a as P,r,j as e,i as a,Q as g,U as w,V as R,e as S}from"./index-D_SXNO0_.js";import{I as h}from"./input-DQHqsI9s.js";import{B as m}from"./button-CfbM7yIF.js";import{C as E,a as B,b as I,d as M}from"./card-Dfoe_-5d.js";import{M as D}from"./mail-D8zLKzfV.js";import{C as F}from"./circle-check-big-BSzhsfPf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=q("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),T=()=>{const u=P(),[o,f]=r.useState("request"),[t,b]=r.useState(""),[d,p]=r.useState(""),[i,j]=r.useState(""),[c,n]=r.useState(!1),[x,v]=r.useState(void 0),C=async()=>{if(!t){a.error("يرجى إدخال البريد الإلكتروني أولاً");return}n(!0);try{const l=await g(w,"requestPasswordResetCode")({email:t}),{sent:N,devCode:k}=l.data||{};N?a.success("تم إرسال الكود إلى بريدك الإلكتروني"):a.message("تم إنشاء الكود (وضع التطوير)",{description:"يعرض الكود مباشرة لعدم إعداد البريد."}),v(k),f("confirm")}catch(s){console.warn("requestPasswordResetCode failed, falling back to sendPasswordResetEmail:",s);try{await R(S,t),a.message("تم إرسال رابط استعادة كلمة المرور",{description:"لم نستطع استخدام كود التحقق، استخدم الرابط المرسل."})}catch(l){a.error((l==null?void 0:l.message)||(s==null?void 0:s.message)||"حدث خطأ أثناء طلب الكود")}}finally{n(!1)}},y=async()=>{if(!t||!d||!i){a.error("الرجاء ملء جميع الحقول");return}if(i.length<6){a.error("كلمة المرور يجب ألا تقل عن 6 أحرف");return}n(!0);try{await g(w,"confirmPasswordResetCode")({email:t,code:d,newPassword:i}),a.success("تم تحديث كلمة المرور بنجاح"),u("/user/login")}catch(s){a.error((s==null?void 0:s.message)||"تعذر تأكيد الكود")}finally{n(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsx("div",{className:"relative w-full max-w-md",children:e.jsxs(E,{className:"bg-white/10 backdrop-blur-lg border border-white/20 text-white",children:[e.jsx(B,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[o==="request"?e.jsx(D,{className:"w-5 h-5"}):e.jsx(K,{className:"w-5 h-5"}),o==="request"?"استعادة كلمة المرور بواسطة كود":"أدخل الكود وكلمة مرور جديدة"]})}),e.jsxs(M,{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-200 mb-2",children:"البريد الإلكتروني"}),e.jsx(h,{type:"email",placeholder:"أدخل بريدك الإلكتروني",value:t,onChange:s=>b(s.target.value),className:"bg-white/20 border-white/30 text-white placeholder-gray-300",dir:"rtl",required:!0})]}),o==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-200 mb-2",children:"رمز التحقق"}),e.jsx(h,{type:"text",placeholder:"أدخل الكود المرسل بالبريد",value:d,onChange:s=>p(s.target.value),className:"bg-white/20 border-white/30 text-white placeholder-gray-300",dir:"rtl",required:!0}),x&&e.jsxs("div",{className:"mt-2 text-xs text-yellow-300 flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),"كود التطوير: ",x]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-2 00 mb-2",children:"كلمة مرور جديدة"}),e.jsx(h,{type:"password",placeholder:"أدخل كلمة مرور جديدة",value:i,onChange:s=>j(s.target.value),className:"bg-white/20 border-white/30 text-white placeholder-gray-300",dir:"rtl",autoComplete:"new-password",required:!0})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[o==="request"?e.jsx(m,{onClick:C,disabled:c,className:"bg-green-600 hover:bg-green-700",children:c?"جاري الإرسال...":"إرسال الكود"}):e.jsx(m,{onClick:y,disabled:c,className:"bg-green-600 hover:bg-green-700",children:c?"جاري التأكيد...":"تأكيد وتحديث كلمة السر"}),e.jsx(m,{variant:"ghost",onClick:()=>u("/user/login"),className:"text-gray-300 hover:text-white",children:"العودة لتسجيل الدخول"})]})]})]})})]})};export{T as default};
