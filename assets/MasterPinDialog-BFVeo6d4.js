import{c as B,r as l,d as O,j as e}from"./index-B4rr4Fr9.js";import{B as f}from"./button-C40VjUZp.js";import{I as u}from"./input-B1SYo6-5.js";import{L as g}from"./label-B793cNH3.js";import{D as S,a as T,b as A,c as H}from"./dialog-DGVHnQzO.js";import{M as n}from"./masterPinService-B5aWu8_y.js";import{S as R}from"./shield-wDJk5gwp.js";import{E as j,a as v}from"./eye-CEmYMwfa.js";import{C as q}from"./circle-alert-C-i3i6jF.js";import{L as G}from"./lock-BezpFebu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=B("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),se=({open:L,onOpenChange:E,onSuccess:r,title:F="الرقم السري الرئيسي",description:I="رقم سري موحد لإدارة جميع عناصر الموقع",mode:s="verify"})=>{const[o,N]=l.useState(""),[i,y]=l.useState(""),[m,b]=l.useState(""),[x,P]=l.useState(!1),[p,w]=l.useState(!1),[d,C]=l.useState(!1),[M,a]=l.useState(""),[k,t]=l.useState(!1),{toast:D}=O(),h=()=>{N(""),y(""),b(""),a(""),P(!1),w(!1),C(!1),E(!1)},z=async c=>{c.preventDefault(),a(""),t(!0);try{if(s==="verify"){if(!o){a("يرجى إدخال الرقم السري"),t(!1);return}if(!n.verifyMasterPin(o)){a("الرقم السري غير صحيح"),t(!1);return}r==null||r(),h()}else if(s==="create"){if(!i||i.length<4){a("يجب أن يكون الرقم السري 4 أرقام على الأقل"),t(!1);return}if(i!==m){a("الرقم السري وتأكيده غير متطابقين"),t(!1);return}n.createMasterPin(i),D({title:"تم إنشاء الرقم السري الرئيسي",description:"تم إنشاء الرقم السري الرئيسي بنجاح. احفظه جيداً!"}),r==null||r(),h()}else if(s==="change"){if(n.hasMasterPin()){if(!o){a("يرجى إدخال الرقم السري الحالي"),t(!1);return}if(!n.verifyMasterPin(o)){a("الرقم السري الحالي غير صحيح"),t(!1);return}}if(!i||i.length<4){a("يجب أن يكون الرقم السري الجديد 4 أرقام على الأقل"),t(!1);return}if(i!==m){a("الرقم السري الجديد وتأكيده غير متطابقين"),t(!1);return}n.changeMasterPin(o,i),D({title:n.hasMasterPin()?"تم تغيير الرقم السري الرئيسي":"تم تعيين الرقم السري الرئيسي",description:n.hasMasterPin()?"تم تغيير الرقم السري الرئيسي بنجاح":"تم تعيين الرقم السري الرئيسي بنجاح"}),r==null||r(),h()}}catch{a("حدث خطأ أثناء معالجة الرقم السري")}finally{t(!1)}};return e.jsx(S,{open:L,onOpenChange:h,children:e.jsxs(T,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(A,{children:e.jsxs(H,{className:"flex items-center gap-2 text-center justify-center",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600"}),F]})}),e.jsx("div",{className:"text-center text-sm text-gray-600 mb-4",children:I}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[(s==="verify"||s==="change"&&n.hasMasterPin())&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"currentPin",className:"text-right block",children:s==="verify"?"الرقم السري الرئيسي":"الرقم السري الحالي"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{id:"currentPin",type:x?"text":"password",value:o,onChange:c=>N(c.target.value),placeholder:s==="verify"?"أدخل الرقم السري الرئيسي":"أدخل الرقم السري الحالي",className:"pr-10",dir:"ltr"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>P(!x),children:x?e.jsx(j,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})})]})]}),(s==="create"||s==="change")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"newPin",className:"text-right block",children:s==="create"?"الرقم السري الرئيسي الجديد":"الرقم السري الجديد"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{id:"newPin",type:p?"text":"password",value:i,onChange:c=>y(c.target.value),placeholder:"أدخل الرقم السري الجديد",className:"pr-10",dir:"ltr"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>w(!p),children:p?e.jsx(j,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})})]})]}),(s==="create"||s==="change")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"confirmPin",className:"text-right block",children:"تأكيد الرقم السري الجديد"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{id:"confirmPin",type:d?"text":"password",value:m,onChange:c=>b(c.target.value),placeholder:"أعد إدخال الرقم السري الجديد",className:"pr-10",dir:"ltr"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>C(!d),children:d?e.jsx(j,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})})]})]}),M&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:[e.jsx(q,{className:"h-4 w-4"}),M]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:h,className:"flex-1",children:"إلغاء"}),e.jsx(f,{type:"submit",disabled:k,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:k?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري المعالجة..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),s==="verify"?"تحقق":s==="create"?"إنشاء":"تغيير"]})})]})]})]})})};export{se as M,ee as a};
