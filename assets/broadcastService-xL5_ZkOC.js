import{c as m,a0 as M,a1 as b,a2 as A,k as y,o as h,a3 as k,J as E}from"./index-Drf-Kel-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=m("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);async function w({title:i,message:r,audienceKey:o,createdBy:d,linkUrl:s}){const l={title:i,message:r,audienceKey:o,active:!0,createdAt:E(),createdBy:d||null,linkUrl:s||void 0};return(await k(A(y,"broadcasts"),l)).id}function L(i,r){const o=new Map,d=i.map(s=>{const l=M(A(y,"broadcasts"),b("audienceKey","==",s));return h(l,c=>{c.docChanges().forEach(t=>{const a=t.doc.data(),e=t.doc.id,n={...a,id:e};t.type==="removed"?o.delete(e):o.set(e,n)});const v=Array.from(o.values()).filter(t=>t.active===!0);if(v.length===0){r(null);return}const p=v.sort((t,a)=>{var u,f;const e=typeof((u=t.createdAt)==null?void 0:u.toMillis)=="function"?t.createdAt.toMillis():0,n=typeof((f=a.createdAt)==null?void 0:f.toMillis)=="function"?a.createdAt.toMillis():0;return e-n});r(p[p.length-1])},c=>{console.error("subscribeToActiveBroadcasts error:",c),r(null)})});return()=>d.forEach(s=>s())}function T(i,r){const o=new Map,d=i.map(s=>{const l=M(A(y,"broadcasts"),b("audienceKey","==",s));return h(l,c=>{c.docChanges().forEach(t=>{const a=t.doc.data(),e=t.doc.id,n={...a,id:e};t.type==="removed"?o.delete(e):o.set(e,n)});const p=Array.from(o.values()).filter(t=>t.active===!0).sort((t,a)=>{var u,f;const e=typeof((u=t.createdAt)==null?void 0:u.toMillis)=="function"?t.createdAt.toMillis():0;return(typeof((f=a.createdAt)==null?void 0:f.toMillis)=="function"?a.createdAt.toMillis():0)-e});r(p)},c=>{console.error("subscribeToActiveBroadcastsList error:",c),r([])})});return()=>d.forEach(s=>s())}export{B as E,T as a,w as p,L as s};
