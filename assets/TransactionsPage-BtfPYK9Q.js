const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./dailyOperationCountService-FcFPunG6.js","./index-B-XjAwUC.js","./index-b08CzHVB.css","./walletDailyLimitsService-DegFJftD.js","./profitService-BY0QIi_I.js"])))=>i.map(i=>d[i]);
import{J as fs,r as u,a6 as gs,j as t,a1 as bs,a3 as Ae,a4 as Me,as as vs,Y as Xe,u as Dt,B as D,p as vt,C as Ue,z,ar as We,aD as j,a as ys,R as le,aE as js,ab as Ns,v as Q,f as I,w as we,q as U,e as $,an as M,g as ee,aF as ws,o as Ts,ay as V,aG as ce,_ as Cs,aa as Be,K as te,I as Fe,aH as Ds,aq as yt,aI as As,aJ as Ss,d as ze,aK as jt,a9 as H,O as Te}from"./index-B-XjAwUC.js";import{C as Rs,a as Ps,b as ks,d as Es}from"./card-lN9jv91D.js";import{D as $e,a as Ve,b as qe,c as Ge,e as Is}from"./dialog-DxD9bVcD.js";import{u as Os,S as Ls,a as _s,b as Ms,c as Ws,d as Ce}from"./select-Bpeuuuwt.js";import{B as De}from"./badge-DHtwmGfg.js";import{c as At,R as Bs,I as Fs}from"./index-Ct2-hdcO.js";import{u as zs}from"./Combination-nTfbPNvk.js";import{A as Nt,a as wt,C as Us,b as $s,f as W,M as Vs,c as qs,R as Gs,I as Hs}from"./MaintenanceDialog-BncP4I_S.js";import{M as He,P as Xs}from"./MasterPinDialog-DUHGQmyo.js";import{r as Tt,P as de}from"./profitService-BY0QIi_I.js";import{D as Js}from"./dollar-sign-Dw0nQfE2.js";import{C as St}from"./calendar-DoQ2ORML.js";import{A as Ks}from"./arrow-left-hrWZFF9Y.js";import{S as Ys}from"./separator-B7Fy9Il3.js";import{T as Ct}from"./progress-rN4FL5VS.js";import{C as Zs}from"./circle-x-DfS8dCxJ.js";import{C as Qs}from"./circle-check-big-Mr9ORW5x.js";import"./index-Bri5dW0m.js";import"./whatsappService-VLdwIWXa.js";import"./download-CCBfXknR.js";import"./label-BHDlv0P7.js";import"./circle-alert-Cg6kxmBo.js";import"./shield-cWblMUY2.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=fs("BatteryCharging",[["path",{d:"M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-2",key:"1sdynx"}],["path",{d:"M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1",key:"1gkd3k"}],["path",{d:"m11 7-3 5h4l-3 5",key:"b4a64w"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);var Se="Tabs",[ta]=bs(Se,[At]),Rt=At(),[sa,Je]=ta(Se),Pt=u.forwardRef((g,s)=>{const{__scopeTabs:x,value:m,onValueChange:P,defaultValue:k,orientation:S="horizontal",dir:B,activationMode:O="automatic",...R}=g,N=Os(B),[T,_]=gs({prop:m,onChange:P,defaultProp:k??"",caller:Se});return t.jsx(sa,{scope:x,baseId:zs(),value:T,onValueChange:_,orientation:S,dir:N,activationMode:O,children:t.jsx(Ae.div,{dir:N,"data-orientation":S,...R,ref:s})})});Pt.displayName=Se;var kt="TabsList",Et=u.forwardRef((g,s)=>{const{__scopeTabs:x,loop:m=!0,...P}=g,k=Je(kt,x),S=Rt(x);return t.jsx(Bs,{asChild:!0,...S,orientation:k.orientation,dir:k.dir,loop:m,children:t.jsx(Ae.div,{role:"tablist","aria-orientation":k.orientation,...P,ref:s})})});Et.displayName=kt;var It="TabsTrigger",Ot=u.forwardRef((g,s)=>{const{__scopeTabs:x,value:m,disabled:P=!1,...k}=g,S=Je(It,x),B=Rt(x),O=Mt(S.baseId,m),R=Wt(S.baseId,m),N=m===S.value;return t.jsx(Fs,{asChild:!0,...B,focusable:!P,active:N,children:t.jsx(Ae.button,{type:"button",role:"tab","aria-selected":N,"aria-controls":R,"data-state":N?"active":"inactive","data-disabled":P?"":void 0,disabled:P,id:O,...k,ref:s,onMouseDown:Me(g.onMouseDown,T=>{!P&&T.button===0&&T.ctrlKey===!1?S.onValueChange(m):T.preventDefault()}),onKeyDown:Me(g.onKeyDown,T=>{[" ","Enter"].includes(T.key)&&S.onValueChange(m)}),onFocus:Me(g.onFocus,()=>{const T=S.activationMode!=="manual";!N&&!P&&T&&S.onValueChange(m)})})})});Ot.displayName=It;var Lt="TabsContent",_t=u.forwardRef((g,s)=>{const{__scopeTabs:x,value:m,forceMount:P,children:k,...S}=g,B=Je(Lt,x),O=Mt(B.baseId,m),R=Wt(B.baseId,m),N=m===B.value,T=u.useRef(N);return u.useEffect(()=>{const _=requestAnimationFrame(()=>T.current=!1);return()=>cancelAnimationFrame(_)},[]),t.jsx(vs,{present:P||N,children:({present:_})=>t.jsx(Ae.div,{"data-state":N?"active":"inactive","data-orientation":B.orientation,role:"tabpanel","aria-labelledby":O,hidden:!_,id:R,tabIndex:0,...S,ref:s,style:{...g.style,animationDuration:T.current?"0s":void 0},children:_&&k})})});_t.displayName=Lt;function Mt(g,s){return`${g}-trigger-${s}`}function Wt(g,s){return`${g}-content-${s}`}var aa=Pt,Bt=Et,Ft=Ot,zt=_t;const ra=aa,Ut=u.forwardRef(({className:g,...s},x)=>t.jsx(Bt,{ref:x,className:Xe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",g),...s}));Ut.displayName=Bt.displayName;const me=u.forwardRef(({className:g,...s},x)=>t.jsx(Ft,{ref:x,className:Xe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",g),...s}));me.displayName=Ft.displayName;const pe=u.forwardRef(({className:g,...s},x)=>t.jsx(zt,{ref:x,className:Xe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",g),...s}));pe.displayName=zt.displayName;const na=({userId:g,transactions:s=[]})=>{const[x,m]=u.useState(!1),[P,k]=u.useState(!1),[S,B]=u.useState(!1),[O,R]=u.useState({dailyWithdraw:0,dailyTransfer:0,monthlyWithdraw:0,monthlyTransfer:0,lastUpdated:new Date}),{userSubscription:N}=Dt();u.useEffect(()=>{g&&x&&S&&Re()},[g,x,S]);const T=y=>`${y.toFixed(2)} ج.م`,_=async()=>{try{const y=(N==null?void 0:N.subscription)||null,p=(y==null?void 0:y.planType)??(y==null?void 0:y.plan)??null,w=typeof p=="string"?p.toLowerCase():null;if(p===z.ZERO||w==="zero"||w==="0"||p===0)return!0}catch{}try{if(g){const y=await We(g),p=(y==null?void 0:y.planType)??(y==null?void 0:y.plan)??null,w=typeof p=="string"?p.toLowerCase():null;if(p===z.ZERO||w==="zero"||w==="0"||p===0)return!0}}catch{}return!1},se=async()=>{try{const y=await(async()=>{try{const p=(N==null?void 0:N.subscription)||null,w=(p==null?void 0:p.planType)??(p==null?void 0:p.plan)??null,F=typeof w=="string"?w.toLowerCase():null;if(w===z.TAHWEELA||F==="tahweela")return!0}catch{}try{if(g){const p=await We(g),w=(p==null?void 0:p.planType)??(p==null?void 0:p.plan)??null,F=typeof w=="string"?w.toLowerCase():null;if(w===z.TAHWEELA||F==="tahweela")return!0}}catch{}return!1})();if(await _()||y){j({title:"غير متاح لاشتراكك",description:"عرض إجمالي الأرباح غير متاح في هذه الخطة.",variant:"destructive"});return}}catch{}k(!0)},ae=async()=>{try{const y=await(async()=>{try{const p=(N==null?void 0:N.subscription)||null,w=(p==null?void 0:p.planType)??(p==null?void 0:p.plan)??null,F=typeof w=="string"?w.toLowerCase():null;if(w===z.TAHWEELA||F==="tahweela")return!0}catch{}try{if(g){const p=await We(g),w=(p==null?void 0:p.planType)??(p==null?void 0:p.plan)??null,F=typeof w=="string"?w.toLowerCase():null;if(w===z.TAHWEELA||F==="tahweela")return!0}}catch{}return!1})();if(await _()||y){j({title:"غير متاح لاشتراكك",description:"عرض إجمالي الأرباح غير متاح في هذه الخطة.",variant:"destructive"}),k(!1);return}}catch{}B(!0),m(!0),k(!1)},Re=async()=>{if(g)try{if(Array.isArray(s)&&s.length>0){const p=new Date,w=p.getMonth(),F=p.getFullYear(),Pe=Tt.filterVisibleTransactions(s,"daily",g),X=Tt.filterVisibleTransactions(s,"monthly",g);let re=0,q=0,ue=0,G=0;Pe.forEach(L=>{const ne=new Date(L.createdAt),J=String(L.status||"confirmed").toLowerCase();if(ne.toDateString()!==p.toDateString()||J!=="completed"&&J!=="confirmed")return;const K=(L.type||L.txnType||"").toLowerCase(),E={type:K==="withdrawal"?"withdraw":K,amount:Number(L.amount||0),commission:L.commission};E.type==="withdraw"?re+=de.calculateProfitFromTransaction(E):(E.type==="send"||E.type==="receive"||E.type==="transfer")&&(q+=de.calculateProfitFromTransaction(E))}),X.forEach(L=>{const ne=new Date(L.createdAt),J=String(L.status||"confirmed").toLowerCase();if(ne.getMonth()!==w||ne.getFullYear()!==F||J!=="completed"&&J!=="confirmed")return;const K=(L.type||L.txnType||"").toLowerCase(),E={type:K==="withdrawal"?"withdraw":K,amount:Number(L.amount||0),commission:L.commission};E.type==="withdraw"?ue+=de.calculateProfitFromTransaction(E):(E.type==="send"||E.type==="receive"||E.type==="transfer")&&(G+=de.calculateProfitFromTransaction(E))}),R({dailyWithdraw:Math.round(re*100)/100,dailyTransfer:Math.round(q*100)/100,monthlyWithdraw:Math.round(ue*100)/100,monthlyTransfer:Math.round(G*100)/100,lastUpdated:new Date});return}const y=de.getWithdrawTransferProfits(g);R({dailyWithdraw:y.dailyWithdrawProfit||0,dailyTransfer:y.dailyTransferProfit||0,monthlyWithdraw:y.monthlyWithdrawProfit||0,monthlyTransfer:y.monthlyTransferProfit||0,lastUpdated:new Date})}catch(y){console.error("Error loading total profits:",y)}};return t.jsxs(t.Fragment,{children:[t.jsx(D,{size:"sm",variant:"ghost",onClick:se,className:"h-2 w-2 p-0 bg-gradient-to-r from-blue-100 to-purple-200 text-purple-700 hover:from-blue-200 hover:to-purple-300 hover:text-purple-800 rounded transition-all duration-300 hover:scale-110 shadow-sm hover:shadow-md",title:"عرض إجمالي الأرباح",children:t.jsx(vt,{className:"h-1.5 w-1.5"})}),t.jsx($e,{open:x,onOpenChange:m,children:t.jsxs(Ve,{className:"max-w-[240px] mx-auto bg-white border border-gray-200 shadow-md rounded sm:max-w-[220px] sm:bg-gradient-to-br sm:from-purple-50 sm:to-white sm:border-2 sm:border-purple-200 sm:shadow-2xl sm:rounded-2xl",children:[t.jsx(qe,{className:"text-center pb-0 border-b-0 sm:pb-2 sm:border-b sm:border-purple-200",children:t.jsxs(Ge,{className:"text-xs font-bold text-purple-800 flex items-center justify-center gap-1 mb-0 leading-tight tracking-tight sm:text-xs sm:gap-1 sm:mb-0 sm:leading-normal sm:tracking-normal",children:[t.jsx(Js,{className:"h-2 w-2 text-purple-600 sm:h-3 sm:w-3"}),"إجمالي الأرباح (فوري)"]})}),t.jsxs("div",{className:"space-y-1 py-1 sm:space-y-2 sm:py-2",children:[t.jsxs("div",{className:"bg-blue-50 p-1 rounded border border-blue-200 sm:bg-gradient-to-r sm:from-blue-50 sm:to-blue-100 sm:p-2 sm:rounded-xl sm:shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Ue,{className:"h-2 w-2 text-blue-600"}),t.jsx("span",{className:"text-[10px] font-semibold text-blue-800",children:"يومي"})]}),t.jsx("span",{className:"text-[10px] font-bold text-blue-900",children:T((O.dailyWithdraw??0)+(O.dailyTransfer??0))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[t.jsxs("div",{className:"flex items-center justify-between bg-red-50 p-0.5 rounded border border-red-200",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Nt,{className:"h-2 w-2 text-red-600"}),t.jsx("span",{className:"text-[10px] text-red-800",children:"سحب"})]}),t.jsx("span",{className:"text-[10px] font-bold text-red-700",children:T(O.dailyWithdraw)})]}),t.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-0.5 rounded border border-green-200",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(wt,{className:"h-2 w-2 text-green-600"}),t.jsx("span",{className:"text-[10px] text-green-800",children:"تحويل"})]}),t.jsx("span",{className:"text-[10px] font-bold text-green-700",children:T(O.dailyTransfer)})]})]})]}),t.jsxs("div",{className:"bg-purple-50 p-1 rounded border border-purple-200 sm:bg-gradient-to-r sm:from-purple-50 sm:to-purple-100 sm:p-2 sm:rounded-xl sm:shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(St,{className:"h-2 w-2 text-purple-600"}),t.jsx("span",{className:"text-[10px] font-semibold text-purple-800",children:"شهري"})]}),t.jsx("span",{className:"text-[10px] font-bold text-purple-900",children:T((O.monthlyWithdraw??0)+(O.monthlyTransfer??0))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[t.jsxs("div",{className:"flex items-center justify-between bg-red-50 p-0.5 rounded border border-red-200",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Nt,{className:"h-2 w-2 text-red-600"}),t.jsx("span",{className:"text-[10px] text-red-800",children:"سحب"})]}),t.jsx("span",{className:"text-[10px] font-bold text-red-700",children:T(O.monthlyWithdraw)})]}),t.jsxs("div",{className:"flex items-center justify-between bg-blue-50 p-0.5 rounded border border-blue-200",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(wt,{className:"h-2 w-2 text-blue-600"}),t.jsx("span",{className:"text-[10px] text-blue-800",children:"تحويل"})]}),t.jsx("span",{className:"text-[10px] font-bold text-blue-700",children:T(O.monthlyTransfer)})]})]})]})]}),!S&&t.jsx("div",{className:"absolute inset-0 bg-yellow-200/70 backdrop-blur-sm flex items-center justify-center rounded sm:rounded-2xl border border-yellow-300 pointer-events-auto",children:t.jsx(D,{size:"sm",variant:"ghost",onClick:()=>k(!0),className:"p-2 bg-yellow-300/80 text-yellow-900 hover:bg-yellow-400/90 rounded-full shadow-sm hover:shadow-md transition-all duration-300",title:"إدخال الرقم السري الرئيسي",children:t.jsx(vt,{className:"h-4 w-4"})})}),t.jsx("div",{className:"flex justify-center pt-1 border-t-0 sm:pt-2 sm:border-t sm:border-purple-200",children:t.jsx(D,{onClick:()=>m(!1),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-1 rounded-xl text-xs sm:bg-gradient-to-r sm:from-purple-600 sm:to-purple-700 sm:hover:from-purple-700 sm:hover:to-purple-800 sm:px-4 sm:py-1 sm:rounded-xl sm:shadow-lg sm:hover:shadow-xl sm:transition-all sm:duration-300",children:"إغلاق"})})]})}),t.jsx(He,{open:P,onOpenChange:k,onSuccess:ae,description:"لا يمكن الاطلاع على إجمالي الأرباح إلا بإدخال الرقم السري الرئيسي"})]})},oa=g=>t.jsx(na,{...g}),Ia=()=>{var dt,mt,pt,ut,ht,xt,ft,gt,bt;const g=ys(),{user:s,profile:x,userSubscription:m}=Dt(),P=le.useMemo(()=>{var n,o,r,a;const e=((n=m==null?void 0:m.subscription)==null?void 0:n.planType)??((o=m==null?void 0:m.subscription)==null?void 0:o.plan)??((r=x==null?void 0:x.subscription)==null?void 0:r.planType)??((a=x==null?void 0:x.subscription)==null?void 0:a.plan)??null;return e===z.ZERO||String(e).toLowerCase()==="zero"},[(dt=m==null?void 0:m.subscription)==null?void 0:dt.planType,(mt=m==null?void 0:m.subscription)==null?void 0:mt.plan,(pt=x==null?void 0:x.subscription)==null?void 0:pt.planType,(ut=x==null?void 0:x.subscription)==null?void 0:ut.plan]),k=le.useMemo(()=>{var n,o,r,a;const e=((n=m==null?void 0:m.subscription)==null?void 0:n.planType)??((o=m==null?void 0:m.subscription)==null?void 0:o.plan)??((r=x==null?void 0:x.subscription)==null?void 0:r.planType)??((a=x==null?void 0:x.subscription)==null?void 0:a.plan)??null;return e===z.TAHWEELA||String(e).toLowerCase()==="tahweela"},[(ht=m==null?void 0:m.subscription)==null?void 0:ht.planType,(xt=m==null?void 0:m.subscription)==null?void 0:xt.plan,(ft=x==null?void 0:x.subscription)==null?void 0:ft.planType,(gt=x==null?void 0:x.subscription)==null?void 0:gt.plan]),{shopName:S}=js(),{isShiftActive:B,shiftUser:O}=Ns(),[R,N]=u.useState([]),[T,_]=u.useState([]),[se,ae]=u.useState(new Set),[Re,y]=u.useState(!1),[p,w]=u.useState(null),[F,Pe]=u.useState("all"),[X,re]=u.useState(""),[q,ue]=u.useState(""),[G,L]=u.useState(""),[ne,J]=u.useState(!1),[K,E]=u.useState(!1),[$t,Ke]=u.useState(!1);le.useEffect(()=>{var n;((n=m==null?void 0:m.subscription)==null?void 0:n.planType)===z.TAHWEELA&&(j({title:"غير متاح لاشتراكك",description:"صفحة المعاملات غير متاحة في باقة تحويله. استخدم لوحة المستخدم للتحويل/السحب فقط.",variant:"destructive"}),g("/user/dashboard"))},[(bt=m==null?void 0:m.subscription)==null?void 0:bt.planType]);const[ia,Vt]=u.useState(!1),[la,qt]=u.useState(!1),[ca,Gt]=u.useState(!1),[Ht,ke]=u.useState(!1),[Xt,Ye]=u.useState(!1),[Jt,Ze]=u.useState(!1),[Kt,Ee]=u.useState(!1),[Yt,Zt]=u.useState(null),[Qt,he]=u.useState(!1),[Z,xe]=u.useState({keepLastCount:30,intervalDays:7,lastResetAt:null});u.useEffect(()=>{(async()=>{if(s!=null&&s.uid)try{const n=await V.getUserData(s.uid),o=(n==null?void 0:n.recentReset)||{},r=Number(o==null?void 0:o.keepLastCount)>0?Number(o.keepLastCount):30,a=Number(o==null?void 0:o.intervalDays)>0?Number(o.intervalDays):7,d=c=>c instanceof Date?c:typeof(c==null?void 0:c.toDate)=="function"?c.toDate():c?new Date(String(c)):null,f=o!=null&&o.lastResetAt?d(o.lastResetAt):null,l=new Date;!f||l.getTime()-f.getTime()>=a*24*60*60*1e3?(await V.updateUserData(s.uid,{recentReset:{keepLastCount:r,intervalDays:a,lastResetAt:l}}),xe({keepLastCount:r,intervalDays:a,lastResetAt:l})):xe({keepLastCount:r,intervalDays:a,lastResetAt:f})}catch{xe({keepLastCount:30,intervalDays:7,lastResetAt:null})}})()},[s==null?void 0:s.uid]);const[es,fe]=u.useState(!1),[ge,Qe]=u.useState(""),[oe,et]=u.useState(""),[be,tt]=u.useState(""),[st,at]=u.useState(!1),[rt,ve]=u.useState(0);u.useEffect(()=>{if(!(s!=null&&s.uid)){ve(0);return}const e=Q(I,"users",s.uid),n=we(e,o=>{try{const r=o.exists()?o.data():{},d=(Array.isArray(r==null?void 0:r.debts)?r.debts:[]).filter(f=>(f==null?void 0:f.status)==="pending"&&(Number(f==null?void 0:f.amount)||0)>0).length;ve(d)}catch{ve(0)}},o=>{console.warn("فشل الاشتراك في ديون المستخدم من Firestore:",o),ve(0)});return()=>n()},[s==null?void 0:s.uid]),u.useEffect(()=>{ts(),ss()},[s]),u.useEffect(()=>{(async()=>{try{if(!(s!=null&&s.uid)){ae(new Set);return}const e=U($(I,"deletedTransactions"),M("userId","==",s.uid),M("permanent","==",!0)),o=(await ee(e)).docs.flatMap(r=>{const a=r.data();return[a.originalTransactionId,a.transactionId,a.reference,r.id].filter(Boolean).map(String)});ae(new Set(o))}catch{ae(new Set)}})()},[s==null?void 0:s.uid]),u.useEffect(()=>{(async()=>{try{if(!(s!=null&&s.uid))return;const n=new Date;if(n.getDate()!==1)return;const o=`${n.getFullYear()}-${n.getMonth()+1}`,r=`lastMonthlyDbCleanup:${s.uid}`;if(localStorage.getItem(r)===o)return;const d=new Date(n.getFullYear(),n.getMonth(),1,0,0,0,0),f=c=>c instanceof Date?c:typeof(c==null?void 0:c.toDate)=="function"?c.toDate():new Date(String(c));let l=[];try{const c=U($(I,"userTransactions"),M("userId","==",s.uid),M("createdAt","<",d));l=(await ee(c)).docs}catch{const c=U($(I,"userTransactions"),M("userId","==",s.uid));l=(await ee(c)).docs.filter(b=>{var v;return f((v=b.data())==null?void 0:v.createdAt)<d})}await Promise.allSettled(l.map(c=>jt(c.ref)));let i=[];try{const c=U($(I,"transactions"),M("userId","==",s.uid),M("createdAt","<",d));i=(await ee(c)).docs}catch{const c=U($(I,"transactions"),M("userId","==",s.uid));i=(await ee(c)).docs.filter(b=>{var v;return f((v=b.data())==null?void 0:v.createdAt)<d})}await Promise.allSettled(i.map(c=>jt(c.ref)));try{localStorage.setItem(r,o)}catch{}console.log("✅ تنظيف شهري (TransactionsPage):",{userTransactionsDeleted:l.length,globalTransactionsDeleted:i.length,monthStart:d})}catch(n){console.error("فشل التنظيف الشهري التلقائي (TransactionsPage):",n)}})()},[s==null?void 0:s.uid]),u.useEffect(()=>{if(!(s!=null&&s.uid))return;let e=null,n=!1;const o=a=>{const f=a.map(l=>{const i=l.data(),c=i==null?void 0:i.createdAt,h=c!=null&&c.toDate?c.toDate():c instanceof Date?c:new Date(c);return{id:l.id,...i,createdAt:h}}).filter(l=>(l==null?void 0:l.status)!=="cancelled"&&!(l!=null&&l.isDeleted)).filter(l=>!((l==null?void 0:l.type)==="report"||((l==null?void 0:l.title)||"").includes("إيصال تسليم وردية"))).sort((l,i)=>{const c=l.createdAt?new Date(l.createdAt).getTime():0;return(i.createdAt?new Date(i.createdAt).getTime():0)-c}).filter(l=>{const i=String(l.id||""),c=String(l.transactionId||""),h=String(l.reference||l.transactionReference||"");return!se.has(i)&&(!c||!se.has(c))&&(!h||!se.has(h))});N(f.map(Oe))},r=()=>{const a=U($(I,"userTransactions"),M("userId","==",s.uid));e=we(a,d=>{try{o(d.docs)}catch(f){console.error("خطأ في معالجة بيانات الاشتراك الاحتياطي:",f)}},d=>{console.error("خطأ في الاشتراك الاحتياطي لمعاملات المستخدم:",d)})};(async()=>{try{const a=U($(I,"userTransactions"),M("userId","==",s.uid)),d=await ws(a);if(d&&d.docs&&d.docs.length>0)try{o(d.docs)}catch{}}catch{}})();try{let a=U($(I,"userTransactions"),M("userId","==",s.uid),Ts("createdAt","desc"),limit(200));try{e=we(a,{includeMetadataChanges:!0},d=>{try{o(d.docs)}catch(f){console.error("خطأ في معالجة بيانات الاشتراك:",f)}},d=>{if(console.error("خطأ في الاشتراك لمعاملات المستخدم:",d),!n){n=!0;try{e&&e()}catch{}r()}})}catch{const f=U($(I,"userTransactions"),M("userId","==",s.uid));e=we(f,l=>{try{o(l.docs)}catch{}},l=>{console.error("خطأ في الاشتراك البسيط لمعاملات المستخدم:",l),n||(n=!0,r())})}}catch(a){console.error("فشل إعداد الاشتراك الفوري لمعاملات المستخدم، بدء السقوط الاحتياطي:",a),r()}return()=>{try{e&&e()}catch{}}},[s==null?void 0:s.uid]);const ts=async()=>{try{if(!s)return;const e=U($(I,"deletedTransactions"),M("userId","==",s.uid),M("permanent","==",!0)),[n,o,r]=await Promise.all([V.getUserTransactions(s.uid).catch(()=>[]),V.getByUserId(s.uid).catch(()=>[]),ee(e).then(i=>i.docs.flatMap(c=>{const h=c.data();return[h.originalTransactionId,h.transactionId,h.reference,c.id].filter(Boolean).map(String)})).catch(()=>[])]),a=Array.isArray(n)&&n.length>0?n:Array.isArray(o)?o:[],d=new Set(r),l=(a||[]).map(i=>({...i,createdAt:i.createdAt instanceof Date?i.createdAt:new Date(i.createdAt)})).filter(i=>!((i==null?void 0:i.type)==="report"||((i==null?void 0:i.title)||"").includes("إيصال تسليم وردية"))).filter(i=>{const c=String(i.id||""),h=String(i.transactionId||""),b=String(i.reference||i.transactionReference||"");return!d.has(c)&&(!h||!d.has(h))&&(!b||!d.has(b))});N(l.map(Oe))}catch(e){console.error("خطأ في تحميل معاملات المستخدم من Firestore:",e),j({title:"فشل جلب معاملات المستخدم",description:"قد تكون المشكلة صلاحيات Firestore أو اتصال الشبكة. سيتم عرض المتاح محليًا إن وُجد. جرّب تسجيل الدخول مجددًا أو افتح صفحة اختبار المصادقة.",variant:"destructive"})}},ss=async()=>{try{if(!s)return;const n=(await ce.getDeletedTransactionsByUser(s.uid)).map(o=>({...o,createdAt:o.createdAt instanceof Date?o.createdAt:new Date(o.createdAt)}));_(n.map(Oe))}catch(e){console.error("خطأ في تحميل المعاملات المحذوفة من Firestore:",e),j({title:"فشل جلب المعاملات المحذوفة",description:"تحقق من الصلاحيات والاتصال. يمكن مراجعة صفحة اختبار المصادقة للتشخيص.",variant:"destructive"})}},ie=le.useMemo(()=>{const e=Z.keepLastCount??30;return[...R].sort((o,r)=>r.createdAt.getTime()-o.createdAt.getTime()).slice(0,e)},[R,Z.keepLastCount]),as=le.useMemo(()=>Math.max(0,((R==null?void 0:R.length)||0)-(Z.keepLastCount||30)),[R==null?void 0:R.length,Z.keepLastCount]),nt=ie.filter(e=>{const n=!X||e.senderPhone.includes(X)||e.receiverPhone.includes(X),o=!q||e.createdAt.toDateString()===new Date(q).toDateString(),r=!G||e.createdAt.toTimeString().startsWith(G);return n&&o&&r}),ye=(e,n)=>{switch(e){case"completed":return t.jsx(Qs,{className:`h-4 w-4 ${n==="withdraw"?"text-red-500":"text-green-500"}`});case"pending":return t.jsx(Ue,{className:"h-4 w-4 text-yellow-500"});case"cancelled":return t.jsx(Zs,{className:"h-4 w-4 text-red-500"});default:return t.jsx(Ue,{className:"h-4 w-4 text-gray-500"})}},Ie=e=>{switch(e){case"completed":return"مكتمل";case"pending":return"قيد المراجعة";case"cancelled":return"ملغي";default:return"غير معروف"}},Oe=e=>{const n=((e==null?void 0:e.status)??"").toString().toLowerCase(),o=n==="confirmed"||n==="success"||n==="completed"?"completed":n==="failed"||n==="error"||n==="cancelled"||n==="canceled"?"cancelled":"pending",a=((e==null?void 0:e.type)??(e==null?void 0:e.txnType)??"").toString().toLowerCase()==="withdraw"?"withdraw":"send",d=(e==null?void 0:e.senderPhone)??(e==null?void 0:e.senderMsisdn)??(e==null?void 0:e.sender_msisdn)??(e==null?void 0:e.sender)??(e==null?void 0:e.from)??"",f=(e==null?void 0:e.receiverPhone)??(e==null?void 0:e.receiverMsisdn)??(e==null?void 0:e.receiver_msisdn)??(e==null?void 0:e.receiver)??(e==null?void 0:e.to)??"",l=e==null?void 0:e.createdAt,i=l instanceof Date?l:l!=null&&l.toDate?l.toDate():new Date(l);return{id:e==null?void 0:e.id,senderPhone:d||"غير معروف",receiverPhone:f||"غير معروف",amount:Number((e==null?void 0:e.amount)??0),status:o,type:a,createdAt:i,commission:(e==null?void 0:e.commission)??void 0,withdrawnAmount:(e==null?void 0:e.withdrawnAmount)??void 0,sentAmount:(e==null?void 0:e.sentAmount)??void 0,fromWallet:(e==null?void 0:e.fromWallet)??(e==null?void 0:e.walletId)??void 0,cashierName:(e==null?void 0:e.cashierName)??(e==null?void 0:e.createdByName)??(e==null?void 0:e.cashier)??void 0,commissionMode:(e==null?void 0:e.commissionMode)??(e==null?void 0:e.commission_mode)??void 0,totalCharged:(e==null?void 0:e.totalCharged)??void 0,walletEffectAppliedOnCreation:(e==null?void 0:e.walletEffectAppliedOnCreation)??(e==null?void 0:e.effectsAppliedOnCreation)??(e==null?void 0:e.effectAppliedOnCreation)??!1,fee:(e==null?void 0:e.fee)??void 0}},rs=e=>({id:e.id,type:e.type==="send"?"transfer":"withdraw",sender_msisdn:e.senderPhone,receiver_msisdn:e.receiverPhone,amount:e.amount,commission:e.commission||0,status:e.status==="cancelled"?"failed":e.status,createdAt:e.createdAt.toISOString(),updatedAt:e.createdAt.toISOString(),shopName:S??(x==null?void 0:x.shopName)??(s==null?void 0:s.displayName)??"المحل",cashierName:(e==null?void 0:e.cashierName)??null,commissionMode:(e==null?void 0:e.commissionMode)??void 0,totalCharged:(e==null?void 0:e.totalCharged)??void 0,fee:(e==null?void 0:e.fee)??void 0,note:(e==null?void 0:e.note)??(e==null?void 0:e.notes)??void 0}),Le=e=>{const n=rs(e);Zt(n),Ee(!0)},ns=e=>{w(e),y(!0)},os=async()=>{p&&(await is(p.id),y(!1),w(null))},is=async e=>{try{const n=T.find(a=>a.id===e);if(!n||!s)return;const o=await V.saveUserTransaction(s.uid,{...n,userId:s.uid,status:"completed",cashierName:n.cashierName??"الحساب الرئيسي"});await ce.permanentlyDeleteTransaction(e,s.uid);const r={...n,id:o};N(a=>[...a,r]),_(a=>a.filter(d=>d.id!==e)),j({title:"تم الاسترجاع",description:"تم استرجاع الإيصال إلى حسابك."})}catch(n){console.error("خطأ في استرجاع المعاملة من Firestore:",n),j({title:"فشل الاسترجاع",description:"تحقق من الاتصال ثم أعد المحاولة.",variant:"destructive"})}},ls=async e=>{try{if(!s)return;_(n=>n.filter(o=>o.id!==e)),await ce.permanentlyDeleteTransaction(e,s.uid),await V.removeUserTransaction(s.uid,e),j({title:"تم الحذف نهائيًا",description:"الإيصال لن يعود بعد التحديث."})}catch(n){console.error("فشل الحذف النهائي للمعاملة:",n),j({title:"خطأ في الحذف النهائي",description:"تحقق من الاتصال ثم أعد المحاولة.",variant:"destructive"})}},ot=async e=>{var n,o,r;try{const a=R.find(h=>h.id===e);if(!a||!s)return;try{const h=(n=m==null?void 0:m.subscription)==null?void 0:n.planType;if(h===z.ZERO){const{dailyOperationCountService:b}=await H(async()=>{const{dailyOperationCountService:A}=await import("./dailyOperationCountService-FcFPunG6.js");return{dailyOperationCountService:A}},__vite__mapDeps([0,1,2]),import.meta.url),v=a.type==="send"?"transfer":"withdraw";if(!(await b.checkAndIncrement(s.uid,v,5)).allowed){j({title:"تم بلوغ حد باقة الزيرو",description:"مسموح بحد أقصى 5 تأكيدات يوميًا للتحويل/السحب. جرّب غدًا أو قم بالترقية.",variant:"destructive"});return}}else if(h===z.TAHWEELA){const{dailyOperationCountService:b}=await H(async()=>{const{dailyOperationCountService:A}=await import("./dailyOperationCountService-FcFPunG6.js");return{dailyOperationCountService:A}},__vite__mapDeps([0,1,2]),import.meta.url),v=a.type==="send"?"transfer":"withdraw";if(!(await b.checkAndIncrementCombined(s.uid,v,40)).allowed){j({title:"تم بلوغ حد باقة تحويله",description:"هذه الباقة تسمح بحد أقصى 40 عملية تحويل/سحب يومياً.",variant:"destructive"});return}}}catch(h){console.warn("تعذر التحقق من حد التأكيد اليومي:",h)}const d=await Be.getById(s.uid);if(!(d!=null&&d.shopId))throw new Error("لا يمكن تحديد معرف المتجر (shopId) للمستخدم");const f=Q(I,"dashboardData",d.shopId),l=await te(f);let i=l.exists()?Number(((o=l.data())==null?void 0:o.cashBalance)||0):0,c=l.exists()?((r=l.data())==null?void 0:r.walletBalances)||{}:{};if(a.type==="withdraw"){const h=a.fromWallet||Object.keys(c)[0],b=Number(a.withdrawnAmount??a.amount??0),v=Number(a.commission??0);if(!!!(a!=null&&a.walletEffectAppliedOnCreation)&&h&&b>0){const A=c[h]||0;c[h]=A+b}i=i-b+v,await Te(f,{cashBalance:i,walletBalances:c})}else if(a.type==="send"){const h=Number(a.commission??0),b=Number((a==null?void 0:a.fee)??0),v=Math.max(0,h)+Math.max(0,b);v>0&&(i=i+v,await Te(f,{cashBalance:i}))}await Te(Q(I,"userTransactions",e),{status:"completed",confirmedAt:new Date}),N(h=>h.map(b=>b.id===e?{...b,status:"completed"}:b)),j({title:"تم الإكمال",description:"تم وسم المعاملة كمكتملة."}),Ee(!1)}catch(a){console.error("خطأ في إكمال المعاملة:",a),j({title:"فشل الإكمال",description:"تحقق من الاتصال ثم أعد المحاولة.",variant:"destructive"})}},it=async e=>{var n,o;try{const r=R.find(a=>a.id===e);if(!r||!s)return;N(a=>a.filter(d=>d.id!==e)),_(a=>[{...r},...a]);try{let a={};try{const i=await te(Q(I,"userTransactions",e));a=i.exists()?i.data():{}}catch{}const d=e,f=String((a==null?void 0:a.transactionId)||(r==null?void 0:r.transactionId)||d),l=String((a==null?void 0:a.reference)||(a==null?void 0:a.transactionReference)||(r==null?void 0:r.reference)||(r==null?void 0:r.transactionReference)||"");await V.removeUserTransaction(s.uid,e),await ce.saveDeletedTransaction({...r,userId:s.uid,originalTransactionId:e,transactionId:f,reference:l||void 0,permanent:!0});try{await ce.permanentlyDeleteTransaction(e,s.uid)}catch{}}catch(a){console.warn("تعذر الحذف النهائي من قواعد البيانات في هذه الخطوة، سيتم الحذف من لائحة المحذوفات عند التنفيذ اليدوي للحذف النهائي:",a)}try{const a=await Be.getById(s.uid);if(!(a!=null&&a.shopId))throw new Error("لا يمكن تحديد معرف المتجر (shopId) للمستخدم");const d=Q(I,"dashboardData",a.shopId),f=await te(d);let l=f.exists()?Number(((n=f.data())==null?void 0:n.cashBalance)||0):0,i=f.exists()?((o=f.data())==null?void 0:o.walletBalances)||{}:{};const c=Number(r.withdrawnAmount??r.amount??0),h=Number(r.commission??0),b=r.fromWallet||Object.keys(i)[0],v=!!(r!=null&&r.walletEffectAppliedOnCreation);if(r.type==="send"){const C=Number(r.fee??0),A=Number((r==null?void 0:r.sentAmount)??(r==null?void 0:r.transferredAmount)??r.amount??0);if(r.status==="completed"&&(l=l-(A+h+C)),b&&A>0){const Y=i[b]||0;i[b]=Y+A}}else if(r.type==="withdraw"){if(r.status==="completed"){if(l=l+c-h,b&&c>0){const C=i[b]||0;i[b]=C-c}}else if(b&&v&&c>0){const C=i[b]||0;i[b]=C-c}}await Te(d,{cashBalance:l,walletBalances:i})}catch(a){console.warn("فشل عكس تأثير الأرصدة محليًا:",a)}try{const a=r.fromWallet;if(a){const{walletDailyLimitsService:d}=await H(async()=>{const{walletDailyLimitsService:l}=await import("./walletDailyLimitsService-DegFJftD.js");return{walletDailyLimitsService:l}},__vite__mapDeps([3,1,2]),import.meta.url),f=await d.getWalletLimits(a);if(f){const l=r.type==="send",i={updatedAt:(await H(async()=>{const{serverTimestamp:C}=await import("./index-B-XjAwUC.js").then(A=>A.bi);return{serverTimestamp:C}},__vite__mapDeps([1,2]),import.meta.url)).serverTimestamp()};l?(i.dailyTransferUsed=Math.max(0,(f.dailyTransferUsed||0)-r.amount),i.monthlyTransferUsed=Math.max(0,(f.monthlyTransferUsed||0)-r.amount)):(i.dailyWithdrawUsed=Math.max(0,(f.dailyWithdrawUsed||0)-r.amount),i.monthlyWithdrawUsed=Math.max(0,(f.monthlyWithdrawUsed||0)-r.amount));const{doc:c,setDoc:h}=await H(async()=>{const{doc:C,setDoc:A}=await import("./index-B-XjAwUC.js").then(Y=>Y.bi);return{doc:C,setDoc:A}},__vite__mapDeps([1,2]),import.meta.url),{db:b}=await H(async()=>{const{db:C}=await import("./index-B-XjAwUC.js").then(A=>A.bj);return{db:C}},__vite__mapDeps([1,2]),import.meta.url),v=c(b,"walletLimits",a);await h(v,i,{merge:!0})}}}catch(a){console.warn("فشل استرجاع حدود المحفظة:",a)}try{const{ProfitService:a}=await H(async()=>{const{ProfitService:c}=await import("./profitService-BY0QIi_I.js").then(h=>h.p);return{ProfitService:c}},__vite__mapDeps([4,1,2]),import.meta.url),{ReportsService:d}=await H(async()=>{const{ReportsService:c}=await import("./profitService-BY0QIi_I.js").then(h=>h.a);return{ReportsService:c}},__vite__mapDeps([4,1,2]),import.meta.url),l={txnType:r.type==="send"?"send":"receive",amount:r.amount,commission:r.commission||0,createdAt:r.createdAt,status:"confirmed"},i=a.calculateProfitFromTransaction(l);i>0&&a.addProfit(-i,s.uid);try{d.removeTransactionEffects(r,s.uid)}catch{}}catch(a){console.warn("فشل تحديث التقارير/الأرباح بعد الحذف:",a)}}catch(r){console.error("خطأ أثناء حذف الإيصال:",r)}},lt=u.useRef(!1),ct=Cs();u.useEffect(()=>{!(new URLSearchParams(ct.search).get("autoTestBalances")==="1")||lt.current||(lt.current=!0,(async()=>{var o,r,a,d,f,l;try{if(!s)return;const i=await Be.getById(s.uid);if(!(i!=null&&i.shopId)){console.warn("autoTest: لا يوجد shopId للمستخدم، سيتم إيقاف الاختبار.");return}const c=Q(I,"dashboardData",i.shopId),h=await te(c),b=h.exists()?Number(((o=h.data())==null?void 0:o.cashBalance)||0):0,v=h.exists()?((r=h.data())==null?void 0:r.walletBalances)||{}:{},C=Object.keys(v)[0]||void 0,A=100,Y=5,_e=await V.saveUserTransaction(s.uid,{senderPhone:"auto-test-sender",receiverPhone:"auto-test-receiver",amount:A,status:"pending",type:"withdraw",createdAt:new Date,reference:`AUTO-${Date.now()}`,commission:Y,withdrawnAmount:A,fromWallet:C,cashierName:"AutoTest",commissionMode:"add",totalCharged:A+Y,walletEffectAppliedOnCreation:!1});console.log("autoTest: تم إنشاء إيصال سحب تجريبي:",_e),await ot(_e);const je=await te(c),ds=je.exists()?Number(((a=je.data())==null?void 0:a.cashBalance)||0):0,ms=je.exists()?((d=je.data())==null?void 0:d.walletBalances)||{}:{},ps=b-A+Y,us=C?Number(v[C]||0)+A:void 0;console.log("autoTest: توقع الدرج بعد الإكمال:",ps,"فعلي:",ds),C&&console.log("autoTest: توقع المحفظة بعد الإكمال:",us,"فعلي:",ms[C]),await it(_e);const Ne=await te(c),hs=Ne.exists()?Number(((f=Ne.data())==null?void 0:f.cashBalance)||0):0,xs=Ne.exists()?((l=Ne.data())==null?void 0:l.walletBalances)||{}:{};console.log("autoTest: تحقق نهائي — الدرج قبل/بعد الحذف:",b,hs),C&&console.log("autoTest: تحقق نهائي — المحفظة قبل/بعد الحذف:",v[C]||0,xs[C]||0),j({title:"اختبار الأرصدة (Firestore فقط)",description:"تم إنشاء/إكمال/حذف إيصال تجريبي والتحقق من الأرصدة.",variant:"default"})}catch(i){console.error("autoTest: فشل اختبار الأرصدة:",i),j({title:"فشل اختبار الأرصدة",description:"تحقق من الاتصال ووجود shopId والمحافظ في Firestore.",variant:"destructive"})}})())},[ct.search,s]);const cs=async()=>{var o,r,a;const e="alkaptin678678@gmail.com",n=(r=(o=ze.currentUser)==null?void 0:o.email)==null?void 0:r.toLowerCase();if(!n||n!==e){j({title:"قيد الإنشاء",description:"ميزة الشحن متاحة لهذا الحساب فقط حالياً."});return}if(!ge||!oe||!be){j({title:"بيانات ناقصة",description:"يرجى إدخال رقم وشركة والمبلغ",variant:"destructive"});return}at(!0);try{const f={vodafone_eg:"Vodafone",orange_eg:"Orange",etisalat_eg:"Etisalat",we_eg:"WE"}[oe]??oe,l=new AbortController,i=setTimeout(()=>l.abort(),15e3),c=await((a=ze.currentUser)==null?void 0:a.getIdToken()),h=await fetch("/api/topup",{method:"POST",headers:{"Content-Type":"application/json",...c?{Authorization:`Bearer ${c}`}:{}},body:JSON.stringify({phone:ge,countryCode:"EG",operator:f,amount:Number(be),useLocalAmount:!0}),signal:l.signal});clearTimeout(i);const b=await h.text();let v;try{v=JSON.parse(b)}catch{v={success:!1,message:b||"فشل قراءة استجابة الخادم"}}h.ok&&(v!=null&&v.success)?(j({title:"تم الشحن",description:(v==null?void 0:v.message)||"تم تنفيذ عملية الشحن بنجاح"}),fe(!1),Qe(""),et(""),tt("")):j({title:"فشل الشحن",description:(v==null?void 0:v.message)||"حدث خطأ أثناء طلب الشحن",variant:"destructive"})}catch(d){console.error("Topup request error:",d),(d==null?void 0:d.name)==="AbortError"?j({title:"انتهت المهلة",description:"الخادم لم يستجب في الوقت المحدد. تأكد أن السيرفر يعمل.",variant:"destructive"}):j({title:"خطأ في الاتصال",description:"تعذر الاتصال بالخادم. حاول لاحقاً.",variant:"destructive"})}finally{at(!1)}};return t.jsxs("div",{className:"fixed inset-0 overscroll-y-none overflow-y-auto bg-background p-4",children:[t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>g("/user/dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800",children:[t.jsx(Ks,{className:"h-4 w-4"}),"العودة"]}),t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"المعاملات"})]}),t.jsxs(Rs,{className:"card-modern fade-in-up",children:[t.jsxs(Ps,{className:"pb-2 px-3 pt-3",children:[t.jsx(ks,{className:"text-sm font-bold",children:"المعاملات الأخيرة"}),t.jsxs("div",{className:"flex items-center gap-0.5 mt-1 relative",children:[t.jsxs("div",{className:"flex items-center gap-0.5 flex-1 bg-gray-50 rounded px-1 py-0.5 border border-gray-200 hover:border-blue-300 transition-all duration-200 group relative overflow-hidden max-w-[140px] md:max-w-[220px]",children:[t.jsx(Ys,{className:"h-2 w-2 text-gray-400 group-hover:text-blue-600 transition-colors"}),t.jsx(Fe,{placeholder:"بحث...",value:X,onChange:e=>re(e.target.value),className:"h-3 text-[8px] border-0 bg-transparent focus:ring-0 focus:outline-none text-gray-700 placeholder:text-gray-400"})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-purple-50 text-purple-600 hover:bg-purple-100 border border-purple-200 hover:border-purple-300 transition-all duration-200 hover:scale-105",onClick:()=>{if(P||k){j({title:"غير متاح",description:"إدارة التقسيط غير متاحة في هذه الخطة.",variant:"destructive"});return}E(!0)},title:"إدارة التقسيط",children:t.jsx(Ds,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"تقسيط"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(oa,{userId:s==null?void 0:s.uid,transactions:R}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"أرباح"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-emerald-50 text-emerald-600 hover:bg-emerald-100 border border-emerald-200 hover:border-emerald-300 transition-all duration-200 hover:scale-105",onClick:()=>{j({title:"قيد الإنشاء",description:"هذه الميزة قيد الإنشاء حالياً."})},title:"نافذة شحن سريعة",children:t.jsx(yt,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"شحن"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 hover:border-blue-300 transition-all duration-200 hover:scale-105",onClick:()=>J(!0),title:"آلة حاسبة",children:t.jsx(Us,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"حاسبة"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-green-50 text-green-600 hover:bg-green-100 border border-green-200 hover:border-green-300 transition-all duration-200 hover:scale-105",onClick:()=>{if(P){j({title:"الخطة الحالية لا تسمح",description:"بيانات المبيعات غير متاحة في خطة زيرو. قم بالترقية."});return}Vt(!0)},title:"بيانات المبيعات",children:t.jsx($s,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"مبيعات"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs(D,{variant:"ghost",size:"sm",className:`h-5 w-5 p-0 rounded border transition-all duration-200 hover:scale-105 ${q||G?"bg-purple-100 text-purple-600 border-purple-300":"bg-purple-50 text-purple-600 hover:bg-purple-100 border-purple-200 hover:border-purple-300"}`,onClick:()=>qt(!0),title:"اختيار التاريخ",children:[t.jsx(St,{className:"h-2.5 w-2.5"}),(q||G)&&t.jsx("div",{className:"absolute -top-0.5 -right-0.5 h-1 w-1 bg-purple-500 rounded-full"})]}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"تاريخ"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"relative h-5 w-5 p-0 rounded bg-orange-50 text-orange-600 hover:bg-orange-100 border border-orange-200 hover:border-orange-300 transition-all duration-200 hover:scale-105",onClick:()=>{if(P){j({title:"الخطة الحالية لا تسمح",description:"إدارة الديون غير متاحة في خطة زيرو. قم بالترقية."});return}ke(!0)},title:"إدارة الديون",children:t.jsxs("div",{className:"relative inline-flex items-center justify-center h-full w-full",children:[t.jsx(As,{className:"h-2.5 w-2.5"}),rt>0&&t.jsx("div",{className:"absolute -top-1 -right-1 z-10 min-w-[12px] h-[12px] px-[2px] bg-red-600 text-white rounded-full text-[8px] leading-[12px] flex items-center justify-center pointer-events-none ring-1 ring-white",children:rt})]})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"ديون"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-amber-50 text-amber-700 hover:bg-amber-100 border border-amber-200 hover:border-amber-300 transition-all duration-200 hover:scale-105",onClick:()=>{if(P){j({title:"الخطة الحالية لا تسمح",description:"الصيانة غير متاحة في خطة زيرو. قم بالترقية."});return}Ze(!0)},title:"الصيانة",children:t.jsx(Ss,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"صيانه"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-violet-50 text-violet-600 hover:bg-violet-100 border border-violet-200 hover:border-violet-300 transition-all duration-200 hover:scale-105",onClick:()=>{g("/user/dashboard",{state:{openCashierShiftModal:!0}})},title:"يومية المكنة",children:t.jsx(ea,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"المكنة"})]}),t.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-indigo-50 text-indigo-600 hover:bg-indigo-100 border border-indigo-200 hover:border-indigo-300 transition-all duration-200 hover:scale-105",onClick:()=>{if(P){j({title:"الخطة الحالية لا تسمح",description:"الفيز الائتمانية غير متاحة في خطة زيرو. قم بالترقية."});return}Ye(!0)},title:"الفيز الائتمانية",children:t.jsx(yt,{className:"h-2.5 w-2.5"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"فيز"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 hover:border-red-300 transition-all duration-200 hover:scale-105 relative",onClick:()=>{he(!0)},title:"تصفير المعاملات الأخيرة",children:[t.jsx(Ct,{className:"h-2.5 w-2.5"}),as>0&&t.jsx("div",{className:"absolute -top-0.5 -right-0.5 h-1 w-1 bg-red-500 rounded-full"})]}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"تصفير"})]}),(X||q||G)&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(D,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 rounded bg-red-50 text-red-500 hover:bg-red-100 border border-red-200 hover:border-red-300 transition-all duration-200 hover:scale-105",onClick:()=>{re(""),ue(""),L("")},title:"مسح",children:t.jsx("span",{className:"text-[10px] font-bold",children:"×"})}),t.jsx("span",{className:"text-[10px] font-bold text-gray-700",children:"مسح"})]})]})]})]}),t.jsx(Es,{className:"px-3 pb-3",children:t.jsxs(ra,{value:F,onValueChange:Pe,className:"w-full",children:[t.jsxs(Ut,{className:"hidden sm:grid w-full grid-cols-4 h-10 text-sm bg-gradient-to-r from-gray-50 via-blue-50/30 to-purple-50/30 border border-gray-200/60 rounded-md p-1 shadow-sm relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/5 via-purple-500/5 to-pink-500/5 opacity-0 hover:opacity-100 transition-all duration-200"}),t.jsxs(me,{value:"all",className:"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-blue-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-blue-200/50 hover:bg-blue-50/80 hover:text-blue-700 group",children:[t.jsx("span",{className:"relative z-10",children:"الكل"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded"})]}),t.jsxs(me,{value:"send",className:"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-green-200/50 hover:bg-green-50/80 hover:text-green-700 group",children:[t.jsx("span",{className:"relative z-10",children:"مرسل"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-500/10 to-emerald-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded"})]}),t.jsxs(me,{value:"withdraw",className:"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-amber-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-orange-200/50 hover:bg-orange-50/80 hover:text-orange-700 group",children:[t.jsx("span",{className:"relative z-10",children:"سحب"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/10 to-amber-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded"})]}),t.jsxs(me,{value:"deleted",className:"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-red-500 data-[state=active]:to-rose-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-red-200/50 hover:bg-red-50/80 hover:text-red-700 group",children:[t.jsx("span",{className:"relative z-10",children:"محذوف"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500/10 to-rose-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded"})]})]}),t.jsx(pe,{value:"all",className:"mt-2 receipts-list",children:nt.length===0?t.jsx("div",{className:"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]",children:"لا توجد معاملات محفوظة بعد"}):t.jsx("div",{className:"space-y-1 fade-in-up tab-content-smooth max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400",children:nt.map((e,n)=>t.jsxs("div",{className:"receipts-row flex items-center justify-between p-3 bg-white rounded-lg border hover:shadow-md cursor-pointer transition-all duration-200",onClick:()=>Le(e),children:[t.jsxs("div",{className:"flex items-center gap-1",children:[ye(e.status,e.type),t.jsxs("div",{children:[t.jsx("p",{className:`font-medium text-sm ${e.type==="withdraw"?"text-red-700":"text-green-700"}`,children:e.type==="withdraw"?e.receiverPhone:`${e.senderPhone} → ${e.receiverPhone}`}),e.type==="withdraw"&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-sm font-semibold text-red-600",children:[W(e.amount)," جنيه"]}),t.jsxs("p",{className:"text-xs text-red-600",children:["عمولة: ",W(e.commission||0)," جنيه"]})]}),t.jsxs("p",{className:`text-[10px] ${e.type==="withdraw"?"text-red-700":"text-green-700"}`,children:["تمت بواسطة: ",e.cashierName??"الحساب الرئيسي"]}),t.jsx("p",{className:`text-sm ${e.type==="withdraw"?"text-red-500":"text-green-600"}`,children:e.createdAt.toLocaleString("en-GB")})]})]}),t.jsxs("div",{className:"text-right",children:[e.type!=="withdraw"&&t.jsxs("p",{className:"font-bold text-sm text-green-700",children:[W(e.amount)," جنيه"]}),e.withdrawnAmount&&t.jsxs("p",{className:"text-sm text-red-600",children:["مسحوب: ",W(e.withdrawnAmount)," جنيه"]}),e.sentAmount&&t.jsxs("p",{className:"text-sm text-green-600",children:["مرسل: ",W(e.sentAmount)," جنيه"]}),t.jsx(De,{variant:e.status==="completed"?"default":"secondary",className:`text-sm ${e.status==="completed"?e.type==="withdraw"?"bg-red-100 text-red-800 border-red-300":e.type==="send"?"bg-green-100 text-green-800 border-green-300":"":e.type==="withdraw"?"bg-red-100 text-red-800":""}`,children:e.type==="withdraw"?"سحب":Ie(e.status)})]})]},e.id))})}),t.jsx(pe,{value:"send",className:"mt-2 receipts-list",children:ie.filter(e=>e.type==="send").length===0?t.jsx("div",{className:"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]",children:"لا توجد معاملات إرسال محفوظة بعد"}):t.jsx("div",{className:"space-y-1 fade-in-up tab-content-smooth max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400",children:ie.filter(e=>e.type==="send").map((e,n)=>t.jsxs("div",{className:"receipts-row flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all duration-200",onClick:()=>Le(e),children:[t.jsxs("div",{className:"flex items-center gap-1",children:[ye(e.status,e.type),t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium text-sm text-green-700",children:[e.senderPhone," → ",e.receiverPhone]}),t.jsxs("p",{className:"text-[10px] text-green-700",children:["تمت بواسطة: ",e.cashierName??"الحساب الرئيسي"]}),t.jsx("p",{className:"text-sm text-green-600",children:e.createdAt.toLocaleString("ar-EG")})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"font-bold text-sm text-green-700",children:[W(e.amount)," جنيه"]}),e.sentAmount&&t.jsxs("p",{className:"text-sm text-green-600",children:["مرسل: ",W(e.sentAmount)," جنيه"]}),t.jsx(De,{variant:e.status==="completed"?"default":"secondary",className:`text-sm ${e.status==="completed"?"bg-green-100 text-green-800 border-green-300":""}`,children:Ie(e.status)})]})]},e.id))})}),t.jsx(pe,{value:"withdraw",className:"mt-2 receipts-list",children:ie.filter(e=>e.type==="withdraw").length===0?t.jsx("div",{className:"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]",children:"لا توجد معاملات سحب محفوظة بعد"}):t.jsx("div",{className:"space-y-1 max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400",children:ie.filter(e=>e.type==="withdraw").map((e,n)=>t.jsxs("div",{className:"receipts-row flex items-center justify-between p-3 rounded-lg border cursor-pointer",onClick:()=>Le(e),children:[t.jsxs("div",{className:"flex items-center gap-1",children:[ye(e.status,e.type),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm text-red-700",children:e.receiverPhone}),t.jsxs("p",{className:"text-[10px] text-red-700",children:["تمت بواسطة: ",e.cashierName??"الحساب الرئيسي"]}),t.jsx("p",{className:"text-sm text-red-500",children:e.createdAt.toLocaleString("ar-EG")})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"font-bold text-sm text-red-700",children:[W(e.amount)," جنيه"]}),e.withdrawnAmount&&t.jsxs("p",{className:"text-sm text-red-600",children:["مسحوب: ",W(e.withdrawnAmount)," جنيه"]}),t.jsx(De,{variant:e.status==="completed"?"default":"secondary",className:`text-sm ${e.status==="completed"?"bg-red-100 text-red-800 border-red-300":"bg-red-100 text-red-800"}`,children:Ie(e.status)})]})]},e.id))})}),t.jsx(pe,{value:"deleted",className:"mt-2",children:T.length===0?t.jsx("div",{className:"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]",children:"لا توجد معاملات محذوفة"}):t.jsx("div",{className:"space-y-1 max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400",children:T.map((e,n)=>t.jsxs("div",{className:"receipts-row flex items-center justify-between p-3 rounded-lg border",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[ye(e.status,e.type),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm text-red-700",children:e.type==="withdraw"?e.receiverPhone:`${e.senderPhone} → ${e.receiverPhone}`}),e.type==="withdraw"&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-sm font-semibold text-red-600",children:[W(e.amount)," جنيه"]}),t.jsxs("p",{className:"text-xs text-orange-500",children:["عمولة: ",W(e.commission||0)," جنيه"]})]}),t.jsxs("p",{className:"text-[10px] text-red-700",children:["تمت بواسطة: ",e.cashierName??"الحساب الرئيسي"]}),t.jsx("p",{className:"text-sm text-red-500",children:e.createdAt.toLocaleString("ar-EG")})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"text-right mr-2",children:[e.type!=="withdraw"&&t.jsxs("p",{className:"font-bold text-sm text-red-700",children:[W(e.amount)," جنيه"]}),t.jsx(De,{variant:"secondary",className:"text-[10px] bg-red-100 text-red-800",children:"محذوف"})]}),t.jsx(D,{variant:"ghost",size:"sm",className:"text-green-600 hover:bg-green-100 h-10 sm:h-12 px-4 sm:px-5 min-w-[44px] touch-manipulation",onClick:()=>ns(e),children:t.jsx("span",{className:"text-xs sm:text-sm",children:"استرجاع"})}),t.jsx(D,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-100 h-10 sm:h-12 px-3 sm:px-4 min-w-[44px] touch-manipulation",onClick:()=>ls(e.id),children:t.jsx(Ct,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})]},e.id))})})]})})]}),t.jsx(Vs,{open:Jt,onOpenChange:Ze})]}),t.jsx(qs,{isOpen:Xt,onClose:()=>Ye(!1)}),t.jsx(He,{open:Ht,onOpenChange:ke,mode:"verify",title:"الرقم السري الرئيسي لفتح الديون",description:"أدخل الرقم السري الرئيسي لفتح صفحة الديون",onSuccess:()=>{ke(!1),Gt(!0)}}),t.jsx(Xs,{open:Qt,onOpenChange:he,title:"تأكيد كلمة المرور لتصفير المعاملات الأخيرة",description:"سيتم حذف كل المعاملات السابقة نهائيًا من حسابك وFirebase.",onSuccess:async()=>{try{if(!(s!=null&&s.uid)){he(!1);return}const e=new Date,n=o=>o instanceof Date?o:typeof(o==null?void 0:o.toDate)=="function"?o.toDate():new Date(String(o));await V.updateUserData(s.uid,{recentReset:{keepLastCount:Z.keepLastCount??30,intervalDays:Z.intervalDays??7,lastResetAt:e}}),xe(o=>({...o,lastResetAt:e})),j({title:"تم إخفاء المعاملات السابقة",description:"تم إخفاء كل الإيصالات الأقدم من وقت التصفير من العرض بدون التأثير على التقارير اليومية/الشهرية أو الحدود."})}catch(e){console.error("فشل تنفيذ التصفير النهائي:",e),j({title:"فشل التصفير",description:"تحقق من الاتصال ثم أعد المحاولة.",variant:"destructive"})}finally{he(!1)}}}),t.jsx($e,{open:es,onOpenChange:e=>{var n,o;if(e){const r="alkaptin678678@gmail.com",a=(o=(n=ze.currentUser)==null?void 0:n.email)==null?void 0:o.toLowerCase();if(!a||a!==r){j({title:"قيد الإنشاء",description:"هذه الميزة قيد الإنشاء حالياً."});return}fe(!0)}else fe(!1)},children:t.jsxs(Ve,{dir:"rtl",className:"sm:max-w-md",children:[t.jsx(qe,{children:t.jsx(Ge,{children:"شحن رصيد الموبايل"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-right mb-1",children:"رقم الموبايل"}),t.jsx(Fe,{value:ge,onChange:e=>Qe(e.target.value),placeholder:"01XXXXXXXXX",dir:"ltr"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-right mb-1",children:"الشركة"}),t.jsxs(Ls,{value:oe,onValueChange:et,children:[t.jsx(_s,{className:"w-full",children:t.jsx(Ms,{placeholder:"اختر الشركة"})}),t.jsxs(Ws,{children:[t.jsx(Ce,{value:"vodafone_eg",children:"فودافون"}),t.jsx(Ce,{value:"orange_eg",children:"أورنج"}),t.jsx(Ce,{value:"etisalat_eg",children:"اتصالات"}),t.jsx(Ce,{value:"we_eg",children:"WE"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-right mb-1",children:"المبلغ بالجنيه"}),t.jsx(Fe,{type:"number",min:1,value:be,onChange:e=>tt(e.target.value?Number(e.target.value):""),placeholder:"50"})]}),t.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2",children:[t.jsx(D,{variant:"outline",onClick:()=>fe(!1),children:"إلغاء"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(D,{variant:"secondary",onClick:()=>g("/topup"),children:"صفحة الشحن الكاملة"}),t.jsx(D,{onClick:cs,disabled:st||!ge||!oe||!be,children:st?"جارٍ التنفيذ...":"تأكيد الشحن"})]})]})]})]})}),t.jsx($e,{open:Re,onOpenChange:y,children:t.jsxs(Ve,{className:"sm:max-w-[460px]",children:[t.jsxs(qe,{children:[t.jsx(Ge,{children:"تأكيد استرجاع الإيصال"}),t.jsx(Is,{children:"سيتم إعادة الإيصال إلى قائمة المعاملات الحالية."})]}),p&&t.jsxs("div",{className:"mt-2 space-y-2 text-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"المبلغ"}),t.jsxs("span",{className:"font-bold",children:[p.amount," جنيه"]})]}),p.type==="withdraw"?t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"العميل"}),t.jsx("span",{className:"font-medium",children:p.receiverPhone})]}):t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"من → إلى"}),t.jsxs("span",{className:"font-medium",children:[p.senderPhone," → ",p.receiverPhone]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"الكاشير"}),t.jsx("span",{className:"font-medium",children:p.cashierName??"الحساب الرئيسي"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"التاريخ"}),t.jsx("span",{className:"font-medium",children:p.createdAt.toLocaleString("ar-EG")})]})]}),t.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3",children:[t.jsx(D,{variant:"outline",onClick:()=>{y(!1),w(null)},children:"إلغاء"}),t.jsx(D,{onClick:os,children:"تأكيد الاسترجاع"})]})]})}),t.jsx(Gs,{isOpen:Kt,onClose:()=>Ee(!1),transaction:Yt,onPrint:()=>window.print(),onDelete:it,onComplete:ot}),t.jsx(He,{open:K,onOpenChange:E,mode:"verify",title:"فتح إدارة التقسيط",description:"أدخل الرقم السري الرئيسي للوصول إلى إدارة التقسيط",onSuccess:()=>{E(!1),Ke(!0)}}),t.jsx(Hs,{open:$t,onOpenChange:Ke})]})};export{Ia as default};
