import{c as Y,r as i,j as e,d as _,a7 as U,a as Z,u as ee,au as se,av as te,aw as ae,ax as u,ay as re}from"./index-BDn-rBfC.js";import{C as b,a as N,b as y,d as v}from"./card-Dm-GQ19Z.js";import{B as x}from"./button-t7xYfvtz.js";import{I as w}from"./input-B6YaFEgM.js";import{L as C}from"./label-Bo4BM4bY.js";import{a as F}from"./avatars-BbBLh_fB.js";import{a as le,M as B}from"./MasterPinDialog--wYjoy5s.js";import{S as V}from"./shield-CK_v9unZ.js";import{S as ne}from"./square-pen-B8U_MVRK.js";import{S as ie,a as ce}from"./switch-BCoo4U2l.js";import{A as oe}from"./arrow-left-D1rYvYIw.js";import{U as de}from"./user-BQAKB4jW.js";import{S as O}from"./share-2-DLa5ikj6.js";import{C as me}from"./copy-DZmxA5Go.js";import{M as xe}from"./minus-BpVmfcXe.js";import{C as P}from"./crown-QcBiSfct.js";import{R as he}from"./refresh-cw-DDozokb1.js";import"./dialog-CcVomrHc.js";import"./Combination-D0XMK_xj.js";import"./eye-DHgPTmSd.js";import"./circle-alert-U9J8T7jG.js";import"./lock-BfWgkbLj.js";import"./index-Czgcmxau.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=Y("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),ue=({selectedAvatarId:o,onAvatarSelect:c,className:t=""})=>{const[s,d]=i.useState(!1),h=F.find(l=>l.id===o);return e.jsxs("div",{className:`relative ${t}`,children:[e.jsx("button",{onClick:()=>d(!s),className:"w-20 h-20 rounded-full border-4 border-blue-500 hover:border-blue-600 transition-colors duration-200 bg-white shadow-lg overflow-hidden",type:"button",children:h?e.jsx("div",{className:"w-full h-full",children:h.component}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:"اختر صورة البروفيل"}),s&&e.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 min-w-max",children:[e.jsx("div",{className:"grid grid-cols-5 gap-3",children:F.map(l=>e.jsx("button",{onClick:()=>{c(l.id),d(!1)},className:`w-16 h-16 rounded-full border-2 transition-all duration-200 hover:scale-105 overflow-hidden ${o===l.id?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-blue-400"}`,type:"button",title:l.name,children:e.jsx("div",{className:"w-full h-full",children:l.component})},l.id))}),e.jsx("button",{onClick:()=>d(!1),className:"mt-3 w-full py-2 text-sm text-gray-500 hover:text-gray-700 transition-colors",type:"button",children:"إغلاق"})]}),s&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)})]})},pe=({userId:o})=>{const[c,t]=i.useState(!1),[s,d]=i.useState("create");i.useState(!1);const{toast:h}=_(),l=le.hasMasterPin(),a=()=>o?`master_pin_change_count_${o}`:"master_pin_change_count",p=()=>{try{const n=localStorage.getItem(a());return n?parseInt(n,10):0}catch{return 0}},g=()=>{try{const n=p()+1;localStorage.setItem(a(),String(n))}catch{}},f=()=>{l?(d("change"),t(!0)):(d("create"),t(!0))},j=()=>{t(!1),s==="change"&&g(),h({title:"تم بنجاح",description:l?"تم تغيير الرقم السري الرئيسي":"تم إنشاء الرقم السري الرئيسي"})},S=()=>{t(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:f,className:"flex items-center gap-2 text-sm",children:[e.jsx(V,{className:"h-4 w-4"}),l?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4"}),"تغيير الرقم السري الرئيسي"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4"}),"إنشاء رقم سري رئيسي"]})]}),e.jsx(B,{open:c,onOpenChange:t,mode:s,onSuccess:j,onCancel:S})]})},Ae=()=>{const o=Z(),{toast:c}=_(),{user:t,profile:s,updateUserProfile:d,updateAvatarId:h,refreshProfile:l,userSubscription:a,isSubscriptionActive:p,checkSubscriptionStatus:g}=ee(),{fontSize:f,setFontSize:j,isMobile:S}=se(),[n,I]=i.useState({fullName:(s==null?void 0:s.fullName)||"",phone:(s==null?void 0:s.phone)||"",avatarId:(s==null?void 0:s.avatarId)||"",transferCodeLink:(s==null?void 0:s.transferCodeLink)||""}),[M,R]=i.useState(!1),[k,T]=i.useState(!1),[q,z]=i.useState(!1),[H,L]=i.useState(!1),[$,E]=i.useState(null);i.useEffect(()=>{try{const r=t!=null&&t.uid?`dailyReportsLockEnabled_${t.uid}`:"dailyReportsLockEnabled",m=localStorage.getItem(r)??localStorage.getItem("dailyReportsLockEnabled");z(m==="true")}catch{}},[t==null?void 0:t.uid]);const K=r=>{E(r),L(!0)};i.useEffect(()=>{(async()=>{try{await g(),console.log("تم تحديث بيانات الاشتراك عند تحميل صفحة البروفايل")}catch(m){console.error("خطأ في تحديث بيانات الاشتراك:",m)}})()},[g]);const D=r=>{const{name:m,value:W}=r.target;I(X=>({...X,[m]:W}))},G=r=>{I(m=>({...m,avatarId:r}))},J=async r=>{r.preventDefault(),R(!0);try{await d({fullName:n.fullName,phone:n.phone,transferCodeLink:n.transferCodeLink}),n.avatarId!==(s==null?void 0:s.avatarId)&&await h(n.avatarId),await l(),c({title:"تم التحديث بنجاح",description:"تم حفظ إعدادات البروفيل بنجاح"}),setTimeout(()=>{o(-1)},500)}catch(m){console.error("Error updating profile:",m),c({title:"خطأ في التحديث",description:"حدث خطأ أثناء حفظ الإعدادات",variant:"destructive"})}finally{R(!1)}},Q=async()=>{T(!0);try{await l(),await g(),console.log("تم تحديث بيانات الاشتراك يدوياً:",{userSubscription:a,isSubscriptionActive:p}),c({title:"تم تحديث بيانات الاشتراك",description:"تم تحديث معلومات اشتراكك بنجاح"})}catch(r){console.error("Error refreshing subscription:",r),c({title:"خطأ في التحديث",description:"حدث خطأ أثناء تحديث بيانات الاشتراك",variant:"destructive"})}finally{T(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>o(-1),className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"العودة"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"إعدادات البروفيل"})]}),e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"تحديث بيانات البروفيل"]})}),e.jsx(v,{children:e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"صورة البروفيل"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{selectedAvatarId:n.avatarId,onAvatarSelect:G})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"fullName",children:"الاسم الكامل"}),e.jsx(w,{id:"fullName",name:"fullName",type:"text",value:n.fullName,onChange:D,placeholder:"أدخل اسمك الكامل",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"phone",children:"رقم الهاتف"}),e.jsx(w,{id:"phone",name:"phone",type:"tel",value:n.phone,onChange:D,placeholder:"أدخل رقم هاتفك",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"transferCodeLink",children:"رابط الجسر (Ngrok)"}),e.jsx(w,{id:"transferCodeLink",name:"transferCodeLink",type:"url",value:n.transferCodeLink,onChange:D,placeholder:"مثال: https://xxx.ngrok-free.app",className:"text-right"}),e.jsxs("div",{className:"text-xs text-gray-500 text-right",children:["أدخل رابط ngrok الخاص بك؛ سيتم الإرسال إلى ","<link>/sendUSSD","."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email",children:"البريد الإلكتروني"}),e.jsx(w,{id:"email",name:"email",type:"email",value:(t==null?void 0:t.email)||"",readOnly:!0,placeholder:"البريد المرتبط بحسابك",className:"text-right"})]}),e.jsx(x,{type:"submit",disabled:M,className:"w-full h-12 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium transition-all duration-300",children:M?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري الحفظ..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"حفظ التغييرات"]})})]})})]}),e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"رابط الإحالة الخاص بك"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"شارك هذا الرابط مع الأصدقاء للصول على مكافآت عند تسجيلهم"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg border",children:[e.jsx(w,{value:`${window.location.origin}/register?ref=${(s==null?void 0:s.referralCode)||""}`,readOnly:!0,className:"flex-1 bg-transparent border-none text-sm"}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:()=>{const r=`${window.location.origin}/register?ref=${(s==null?void 0:s.referralCode)||""}`;navigator.clipboard.writeText(r),c({title:"تم النسخ",description:"تم نسخ رابط الإحالة إلى الحافظة"})},className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"نسخ"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"رمز الإحالة الخاص بك:"}),e.jsx("span",{className:"text-blue-800 font-bold text-lg",children:(s==null?void 0:s.referralCode)||"غير متوفر"})]}),e.jsxs(x,{onClick:()=>o("/referrals"),variant:"outline",className:"w-full flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"عرض الإحالات والمكافآت"]})]})})]}),e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"إدارة الأرقام السرية"]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"تغيير الأرقام السرية"}),e.jsx("p",{className:"text-sm text-gray-600",children:"إدارة أرقامك السرية للنظام والمحفظة والأرباح"})]}),e.jsx(pe,{})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"قفل تقارير اليوم"}),e.jsx("p",{className:"text-sm text-gray-600",children:"عند التفعيل، يتم تمويه تقارير اليوم ويتطلب الرقم السري الرئيسي لعرضها"})]}),e.jsx(ce,{checked:q,onCheckedChange:K})]}),e.jsx(B,{open:H,onOpenChange:L,mode:"verify",title:"تأكيد التغيير",description:"أدخل الرقم السري الرئيسي لتفعيل أو إلغاء قفل تقارير اليوم",onSuccess:()=>{if($!==null){const r=$;z(r);try{localStorage.setItem("dailyReportsLockEnabled",r?"true":"false"),t!=null&&t.uid&&localStorage.setItem(`dailyReportsLockEnabled_${t.uid}`,r?"true":"false")}catch{}c({title:r?"تم تفعيل قفل تقارير اليوم":"تم إلغاء قفل تقارير اليوم",description:r?"ستظهر تقارير اليوم بتمويه وتتطلب الرقم السري لعرضها.":"ستظهر تقارير اليوم بدون تمويه وبدون رقم سري."})}L(!1),E(null)}})]})]}),S&&e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"حجم الخط"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"تخصيص حجم الخط"}),e.jsx("p",{className:"text-sm text-gray-600",children:"اختر حجم الخط المناسب لك في وضع الموبايل"})]}),e.jsx("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>j("small"),className:`flex items-center gap-2 ${f==="small"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(xe,{className:"h-4 w-4"}),"صغير"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>j("medium"),className:`flex items-center gap-2 ${f==="medium"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(A,{className:"h-4 w-4"}),"متوسط"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>j("large"),className:`flex items-center gap-2 ${f==="large"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(U,{className:"h-4 w-4"}),"كبير"]})]})}),e.jsx("div",{className:"text-sm text-gray-500 bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsx("p",{children:"💡 هذه الميزة تعمل في وضع الموبايل فقط وتؤثر على جميع النصوص في الموقع مع الحفاظ على تناسق الأيقونات"})})]})})]}),e.jsxs(b,{className:"shadow-lg",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-yellow-500"}),"معلومات الاشتراك"]}),e.jsxs(x,{onClick:Q,disabled:k,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(he,{className:`w-4 h-4 ${k?"animate-spin":""}`}),k?"جاري التحديث...":"تحديث"]})]})}),e.jsx(v,{children:p&&(a!=null&&a.subscription)?e.jsx("div",{children:e.jsxs("div",{className:"p-6 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"حالة الاشتراك"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-green-100 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-700 font-medium text-sm",children:"نشط"})]})]}),e.jsx("div",{className:"mb-4 p-4 bg-white/70 rounded-lg border border-green-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"نوع الباقة:"}),e.jsx("span",{className:`font-bold text-lg ${te(a.subscription)}`,children:ae(a.subscription.planType)})]})}),e.jsxs("div",{className:"text-lg font-medium text-gray-700 leading-relaxed",children:[a.subscription.planType==="monthly"&&e.jsxs("p",{children:["اشتراكك الشهري يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.endDate)})]}),a.subscription.planType==="quarterly"&&e.jsxs("p",{children:["اشتراكك ربع السنوي يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.endDate)})]}),a.subscription.planType==="yearly"&&e.jsxs("p",{children:["اشتراكك السنوي يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.endDate)})]}),a.subscription.planType==="lifetime"&&e.jsx("p",{className:"text-yellow-600 font-bold",children:"🎉 اشتراكك مدى الحياة - لا ينتهي أبداً"})]}),p&&a.subscription.planType!=="lifetime"&&a.subscription.planType!=="zero"&&e.jsx("div",{className:"mt-4 p-3 bg-white/50 rounded-lg border border-green-100",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["متبقي ",e.jsx("span",{className:"font-semibold text-green-600",children:re(a.subscription)})," يوم على انتهاء الاشتراك"]})})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"p-6 rounded-lg bg-gradient-to-r from-red-50 to-orange-50 border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-6 w-6 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"حالة الاشتراك"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-red-100 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-red-700 font-medium text-sm",children:"غير نشط"})]})]}),e.jsx("div",{className:"mb-4 p-4 bg-white/70 rounded-lg border border-red-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"نوع الباقة:"}),e.jsx("span",{className:"font-bold text-lg text-gray-500",children:"لا يوجد اشتراك"})]})}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"لا يوجد اشتراك مفعل"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"تواصل مع الإدارة لتفعيل اشتراكك"}),e.jsxs("div",{className:"mt-3 bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"البريد الإلكتروني للإدارة:"}),e.jsx("a",{href:"mailto:info@cashy-link.com",className:"text-sm font-bold text-blue-600 hover:text-blue-700 underline",children:"info@cashy-link.com"})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-2 text-center",children:"يمكنك مراسلتنا لطلب التفعيل أو الاستفسار"})]})]})})})]})]})})};export{Ae as default};
