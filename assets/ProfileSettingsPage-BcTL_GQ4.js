import{c as Y,r as i,j as e,d as _,a6 as B,a as Z,u as ee,af as se,ag as ae,ah as te,ai as u,aj as le}from"./index-BwRCC2gi.js";import{C as b,a as N,b as y,d as v}from"./card-DJoxVmiJ.js";import{B as x}from"./button-BjF52gZr.js";import{I as w}from"./input-DgAXW7tJ.js";import{L as C}from"./label-DTg6W7fr.js";import{a as O}from"./avatars-CbKz_5Yn.js";import{a as re,M as U}from"./MasterPinDialog-BSMDdGhi.js";import{S as V}from"./shield-Du-mfy5m.js";import{S as ne}from"./square-pen-CirUm1gs.js";import{S as ie,a as ce}from"./switch-CxPSD6ok.js";import{A as oe}from"./arrow-left-BJ53ugD3.js";import{U as de}from"./user-Cm6FByOS.js";import{S as F}from"./share-2-Wkusk8DL.js";import{C as me}from"./copy-HMSPmLy8.js";import{M as xe}from"./minus-CPbrZ0ud.js";import{C as P}from"./crown-Dfe1LAFY.js";import{R as he}from"./refresh-cw-C4B3jjsw.js";import"./dialog-DpGDBnRh.js";import"./Combination-DFomfWck.js";import"./eye-BLytke5H.js";import"./circle-alert-BpXfYihb.js";import"./lock-DNRhdsJk.js";import"./index-CSJ34AGp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=Y("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),ue=({selectedAvatarId:o,onAvatarSelect:c,className:a=""})=>{const[s,d]=i.useState(!1),h=O.find(r=>r.id===o);return e.jsxs("div",{className:`relative ${a}`,children:[e.jsx("button",{onClick:()=>d(!s),className:"w-20 h-20 rounded-full border-4 border-blue-500 hover:border-blue-600 transition-colors duration-200 bg-white shadow-lg overflow-hidden",type:"button",children:h?e.jsx("div",{className:"w-full h-full",children:h.component}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:"اختر صورة البروفيل"}),s&&e.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 min-w-max",children:[e.jsx("div",{className:"grid grid-cols-5 gap-3",children:O.map(r=>e.jsx("button",{onClick:()=>{c(r.id),d(!1)},className:`w-16 h-16 rounded-full border-2 transition-all duration-200 hover:scale-105 overflow-hidden ${o===r.id?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-blue-400"}`,type:"button",title:r.name,children:e.jsx("div",{className:"w-full h-full",children:r.component})},r.id))}),e.jsx("button",{onClick:()=>d(!1),className:"mt-3 w-full py-2 text-sm text-gray-500 hover:text-gray-700 transition-colors",type:"button",children:"إغلاق"})]}),s&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)})]})},pe=({userId:o})=>{const[c,a]=i.useState(!1),[s,d]=i.useState("create");i.useState(!1);const{toast:h}=_(),r=re.hasMasterPin(),t=()=>o?`master_pin_change_count_${o}`:"master_pin_change_count",p=()=>{try{const n=localStorage.getItem(t());return n?parseInt(n,10):0}catch{return 0}},g=()=>{try{const n=p()+1;localStorage.setItem(t(),String(n))}catch{}},f=()=>{r?(d("change"),a(!0)):(d("create"),a(!0))},j=()=>{a(!1),s==="change"&&g(),h({title:"تم بنجاح",description:r?"تم تغيير الرقم السري الرئيسي":"تم إنشاء الرقم السري الرئيسي"})},S=()=>{a(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:f,className:"flex items-center gap-2 text-sm",children:[e.jsx(V,{className:"h-4 w-4"}),r?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4"}),"تغيير الرقم السري الرئيسي"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4"}),"إنشاء رقم سري رئيسي"]})]}),e.jsx(U,{open:c,onOpenChange:a,mode:s,onSuccess:j,onCancel:S})]})},Ae=()=>{const o=Z(),{toast:c}=_(),{user:a,profile:s,updateUserProfile:d,updateAvatarId:h,refreshProfile:r,userSubscription:t,isSubscriptionActive:p,checkSubscriptionStatus:g}=ee(),{fontSize:f,setFontSize:j,isMobile:S}=se(),[n,I]=i.useState({fullName:(s==null?void 0:s.fullName)||"",phone:(s==null?void 0:s.phone)||"",avatarId:(s==null?void 0:s.avatarId)||""}),[L,M]=i.useState(!1),[k,R]=i.useState(!1),[q,T]=i.useState(!1),[H,D]=i.useState(!1),[z,$]=i.useState(null);i.useEffect(()=>{try{const l=a!=null&&a.uid?`dailyReportsLockEnabled_${a.uid}`:"dailyReportsLockEnabled",m=localStorage.getItem(l)??localStorage.getItem("dailyReportsLockEnabled");T(m==="true")}catch{}},[a==null?void 0:a.uid]);const K=l=>{$(l),D(!0)};i.useEffect(()=>{(async()=>{try{await g(),console.log("تم تحديث بيانات الاشتراك عند تحميل صفحة البروفايل")}catch(m){console.error("خطأ في تحديث بيانات الاشتراك:",m)}})()},[g]);const E=l=>{const{name:m,value:W}=l.target;I(X=>({...X,[m]:W}))},G=l=>{I(m=>({...m,avatarId:l}))},J=async l=>{l.preventDefault(),M(!0);try{await d({fullName:n.fullName,phone:n.phone}),n.avatarId!==(s==null?void 0:s.avatarId)&&await h(n.avatarId),await r(),c({title:"تم التحديث بنجاح",description:"تم حفظ إعدادات البروفيل بنجاح"}),setTimeout(()=>{o(-1)},500)}catch(m){console.error("Error updating profile:",m),c({title:"خطأ في التحديث",description:"حدث خطأ أثناء حفظ الإعدادات",variant:"destructive"})}finally{M(!1)}},Q=async()=>{R(!0);try{await r(),await g(),console.log("تم تحديث بيانات الاشتراك يدوياً:",{userSubscription:t,isSubscriptionActive:p}),c({title:"تم تحديث بيانات الاشتراك",description:"تم تحديث معلومات اشتراكك بنجاح"})}catch(l){console.error("Error refreshing subscription:",l),c({title:"خطأ في التحديث",description:"حدث خطأ أثناء تحديث بيانات الاشتراك",variant:"destructive"})}finally{R(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>o(-1),className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"العودة"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"إعدادات البروفيل"})]}),e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"تحديث بيانات البروفيل"]})}),e.jsx(v,{children:e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"صورة البروفيل"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{selectedAvatarId:n.avatarId,onAvatarSelect:G})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"fullName",children:"الاسم الكامل"}),e.jsx(w,{id:"fullName",name:"fullName",type:"text",value:n.fullName,onChange:E,placeholder:"أدخل اسمك الكامل",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"phone",children:"رقم الهاتف"}),e.jsx(w,{id:"phone",name:"phone",type:"tel",value:n.phone,onChange:E,placeholder:"أدخل رقم هاتفك",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email",children:"البريد الإلكتروني"}),e.jsx(w,{id:"email",name:"email",type:"email",value:(a==null?void 0:a.email)||"",readOnly:!0,placeholder:"البريد المرتبط بحسابك",className:"text-right"})]}),e.jsx(x,{type:"submit",disabled:L,className:"w-full h-12 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium transition-all duration-300",children:L?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري الحفظ..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"حفظ التغييرات"]})})]})})]}),e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"رابط الإحالة الخاص بك"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"شارك هذا الرابط مع الأصدقاء للصول على مكافآت عند تسجيلهم"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg border",children:[e.jsx(w,{value:`${window.location.origin}/register?ref=${(s==null?void 0:s.referralCode)||""}`,readOnly:!0,className:"flex-1 bg-transparent border-none text-sm"}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:()=>{const l=`${window.location.origin}/register?ref=${(s==null?void 0:s.referralCode)||""}`;navigator.clipboard.writeText(l),c({title:"تم النسخ",description:"تم نسخ رابط الإحالة إلى الحافظة"})},className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"نسخ"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"رمز الإحالة الخاص بك:"}),e.jsx("span",{className:"text-blue-800 font-bold text-lg",children:(s==null?void 0:s.referralCode)||"غير متوفر"})]}),e.jsxs(x,{onClick:()=>o("/referrals"),variant:"outline",className:"w-full flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"عرض الإحالات والمكافآت"]})]})})]}),e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"إدارة الأرقام السرية"]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"تغيير الأرقام السرية"}),e.jsx("p",{className:"text-sm text-gray-600",children:"إدارة أرقامك السرية للنظام والمحفظة والأرباح"})]}),e.jsx(pe,{})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"قفل تقارير اليوم"}),e.jsx("p",{className:"text-sm text-gray-600",children:"عند التفعيل، يتم تمويه تقارير اليوم ويتطلب الرقم السري الرئيسي لعرضها"})]}),e.jsx(ce,{checked:q,onCheckedChange:K})]}),e.jsx(U,{open:H,onOpenChange:D,mode:"verify",title:"تأكيد التغيير",description:"أدخل الرقم السري الرئيسي لتفعيل أو إلغاء قفل تقارير اليوم",onSuccess:()=>{if(z!==null){const l=z;T(l);try{localStorage.setItem("dailyReportsLockEnabled",l?"true":"false"),a!=null&&a.uid&&localStorage.setItem(`dailyReportsLockEnabled_${a.uid}`,l?"true":"false")}catch{}c({title:l?"تم تفعيل قفل تقارير اليوم":"تم إلغاء قفل تقارير اليوم",description:l?"ستظهر تقارير اليوم بتمويه وتتطلب الرقم السري لعرضها.":"ستظهر تقارير اليوم بدون تمويه وبدون رقم سري."})}D(!1),$(null)}})]})]}),S&&e.jsxs(b,{className:"shadow-lg mb-6",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"حجم الخط"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"تخصيص حجم الخط"}),e.jsx("p",{className:"text-sm text-gray-600",children:"اختر حجم الخط المناسب لك في وضع الموبايل"})]}),e.jsx("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>j("small"),className:`flex items-center gap-2 ${f==="small"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(xe,{className:"h-4 w-4"}),"صغير"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>j("medium"),className:`flex items-center gap-2 ${f==="medium"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(A,{className:"h-4 w-4"}),"متوسط"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>j("large"),className:`flex items-center gap-2 ${f==="large"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(B,{className:"h-4 w-4"}),"كبير"]})]})}),e.jsx("div",{className:"text-sm text-gray-500 bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsx("p",{children:"💡 هذه الميزة تعمل في وضع الموبايل فقط وتؤثر على جميع النصوص في الموقع مع الحفاظ على تناسق الأيقونات"})})]})})]}),e.jsxs(b,{className:"shadow-lg",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-yellow-500"}),"معلومات الاشتراك"]}),e.jsxs(x,{onClick:Q,disabled:k,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(he,{className:`w-4 h-4 ${k?"animate-spin":""}`}),k?"جاري التحديث...":"تحديث"]})]})}),e.jsx(v,{children:p&&(t!=null&&t.subscription)?e.jsx("div",{children:e.jsxs("div",{className:"p-6 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"حالة الاشتراك"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-green-100 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-700 font-medium text-sm",children:"نشط"})]})]}),e.jsx("div",{className:"mb-4 p-4 bg-white/70 rounded-lg border border-green-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"نوع الباقة:"}),e.jsx("span",{className:`font-bold text-lg ${ae(t.subscription)}`,children:te(t.subscription.planType)})]})}),e.jsxs("div",{className:"text-lg font-medium text-gray-700 leading-relaxed",children:[t.subscription.planType==="monthly"&&e.jsxs("p",{children:["اشتراكك الشهري يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(t.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(t.subscription.endDate)})]}),t.subscription.planType==="quarterly"&&e.jsxs("p",{children:["اشتراكك ربع السنوي يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(t.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(t.subscription.endDate)})]}),t.subscription.planType==="yearly"&&e.jsxs("p",{children:["اشتراكك السنوي يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(t.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(t.subscription.endDate)})]}),t.subscription.planType==="lifetime"&&e.jsx("p",{className:"text-yellow-600 font-bold",children:"🎉 اشتراكك مدى الحياة - لا ينتهي أبداً"})]}),p&&t.subscription.planType!=="lifetime"&&t.subscription.planType!=="zero"&&e.jsx("div",{className:"mt-4 p-3 bg-white/50 rounded-lg border border-green-100",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["متبقي ",e.jsx("span",{className:"font-semibold text-green-600",children:le(t.subscription)})," يوم على انتهاء الاشتراك"]})})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"p-6 rounded-lg bg-gradient-to-r from-red-50 to-orange-50 border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-6 w-6 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"حالة الاشتراك"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-red-100 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-red-700 font-medium text-sm",children:"غير نشط"})]})]}),e.jsx("div",{className:"mb-4 p-4 bg-white/70 rounded-lg border border-red-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"نوع الباقة:"}),e.jsx("span",{className:"font-bold text-lg text-gray-500",children:"لا يوجد اشتراك"})]})}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"لا يوجد اشتراك مفعل"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"تواصل مع الإدارة لتفعيل اشتراكك"})]})})})]})]})})};export{Ae as default};
