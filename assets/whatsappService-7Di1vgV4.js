import{R as c,i,k as p,p as m,q as b}from"./index-B5n92zOC.js";const r={phoneNumber:"201000392539",defaultMessage:"مرحباً، أريد الاستفسار عن خدماتكم",isEnabled:!0,lastUpdated:new Date},g="whatsapp-settings",h="app-settings",d=async()=>{var e;try{const t=i(p,h,g),a=await m(t);if(a.exists()){const s=a.data();return{phoneNumber:s.phoneNumber||r.phoneNumber,defaultMessage:s.defaultMessage||r.defaultMessage,isEnabled:s.isEnabled!==void 0?s.isEnabled:r.isEnabled,lastUpdated:((e=s.lastUpdated)==null?void 0:e.toDate())||r.lastUpdated}}else return await f(r),r}catch(t){return console.error("خطأ في تحميل إعدادات الواتساب:",t),r}},f=async e=>{try{const t=i(p,h,g),a={...e,lastUpdated:new Date};return await b(t,a,{merge:!0}),!0}catch(t){return console.error("خطأ في حفظ إعدادات الواتساب:",t),!1}},S=e=>{const t=e.replace(/\D/g,"");if(t.length<10)throw new Error("رقم الهاتف يجب أن يحتوي على 10 أرقام على الأقل");return t},y=e=>{try{const t=S(e);return t.length>=10&&t.length<=15}catch{return!1}},E=(e,t)=>{const a=S(e),s=encodeURIComponent(t);return`https://wa.me/${a}?text=${s}`},D=async(e,t,a)=>{const s=await d(),l=`مرحباً! أريد الاشتراك في باقة ${e} بسعر ${t}

المميزات المشمولة:
${a.map(n=>`✅ ${n}`).join(`
`)}

أرجو التواصل معي لإتمام عملية الاشتراك.`;return E(s.phoneNumber,l)},T=()=>{const[e,t]=c.useState(null),[a,s]=c.useState(!0),[l,n]=c.useState(null);return c.useEffect(()=>{(async()=>{try{s(!0);const o=await d();t(o),n(null)}catch(o){n("فشل في تحميل إعدادات الواتساب"),console.error(o)}finally{s(!1)}})()},[]),{settings:e,loading:a,error:l,updateSettings:async u=>{try{return s(!0),await f(u)&&e?(t({...e,...u,lastUpdated:new Date}),n(null),!0):(n("فشل في حفظ الإعدادات"),!1)}catch(o){return n("خطأ في تحديث الإعدادات"),console.error(o),!1}finally{s(!1)}},refreshSettings:()=>d().then(t)}};export{D as a,E as c,T as u,y as v};
