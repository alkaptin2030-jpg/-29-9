import{b as w,a as b,r as m,u as y,d as C,j as e,N as S,L as k}from"./index-BplSILNk.js";import{B as l}from"./button-yxvE-B2p.js";import{I as o}from"./input-ypqzm1mQ.js";import{C as E,a as q,b as I,d as D}from"./card-BbC0oAv9.js";import{S as L}from"./smartphone-DRs5bAg4.js";const P=c=>{const d=c.replace(/\D/g,"");return/^01(0|1|2|5)\d{8}$/.test(d)};function R(){const[c]=w(),d=b(),h=c.get("mode")||"signin",[s,f]=m.useState(h==="signup"),[u,p]=m.useState(!1),[t,n]=m.useState({email:"alkaptin7878@mail.ru",password:"01123456",fullName:"",phone:""}),{signIn:x,signUp:g,user:j}=y(),{toast:i}=C();if(j)return e.jsx(S,{to:"/dashboard-redirect",replace:!0});const v=async a=>{a.preventDefault(),p(!0);try{if(s){if(!P(t.phone))throw i({title:"رقم غير صالح",description:"يجب أن يكون رقم مصري 11 رقم ويبدأ بـ 010/011/012/015",variant:"destructive"}),new Error("رقم الهاتف غير صالح");const{error:r}=await g(t.email,t.password,t.fullName,t.phone);if(r)throw r;i({title:"تم إنشاء الحساب بنجاح!",description:"تحقق من بريدك الإلكتروني لتفعيل الحساب"});const N=t.fullName||"التاجر الجديد";d(`/user/account-setup?user_name=${encodeURIComponent(N)}`)}else{const{error:r}=await x(t.email,t.password);if(r)throw r;i({title:"مرحباً بك!",description:"تم تسجيل الدخول بنجاح، جاري إعداد حسابك..."})}}catch(r){i({title:"خطأ",description:r.message||"حدث خطأ أثناء المعالجة",variant:"destructive"})}finally{p(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-secondary/10 flex items-center justify-center p-4",children:e.jsxs(E,{className:"w-full max-w-md",children:[e.jsxs(q,{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx("div",{className:"h-8 w-8 gradient-primary rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold",children:"CashyLink"})]}),e.jsx(I,{children:s?"إنشاء حساب جديد":"تسجيل الدخول"})]}),e.jsxs(D,{children:[e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s&&e.jsxs(e.Fragment,{children:[e.jsx(o,{placeholder:"الاسم الكامل",value:t.fullName,onChange:a=>n({...t,fullName:a.target.value}),required:!0}),e.jsx(o,{placeholder:"رقم مصري (11 رقم يبدأ بـ 010/011/012/015)",value:t.phone,onChange:a=>n({...t,phone:a.target.value}),dir:"ltr",inputMode:"numeric",required:!0})]}),e.jsx(o,{type:"email",placeholder:"البريد الإلكتروني",value:t.email,onChange:a=>n({...t,email:a.target.value}),required:!0}),e.jsx(o,{type:"password",placeholder:"كلمة المرور",value:t.password,onChange:a=>n({...t,password:a.target.value}),autoComplete:s?"new-password":"off",required:!0}),e.jsx(l,{type:"submit",className:"w-full btn-primary",disabled:u,children:u?"جاري المعالجة...":s?"إنشاء الحساب":"تسجيل الدخول"}),e.jsx(l,{type:"button",variant:"secondary",className:"w-full mt-2",onClick:()=>{n({email:"alkaptin7878@mail.ru",password:"01123456",fullName:"",phone:""}),setTimeout(()=>{const a=document.querySelector("form");a&&a.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},100)},children:"تسجيل دخول كمدير"})]}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("span",{className:"text-muted-foreground",children:s?"لديك حساب؟":"ليس لديك حساب؟"}),e.jsx(l,{variant:"link",onClick:()=>f(!s),className:"text-primary",children:s?"تسجيل الدخول":"إنشاء حساب"})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(k,{to:"/",children:e.jsx(l,{variant:"ghost",className:"text-muted-foreground",children:"العودة للصفحة الرئيسية"})})})]})]})})}export{R as default};
