import{c as G,r as x,j as e,d as A,a2 as R,a as J,u as K,ab as Q,ac as V,ad as W,ae as u,af as X}from"./index-qsZKtsS2.js";import{C as j,a as f,b,d as N}from"./card-4XlYc0JZ.js";import{B as c}from"./button-D46qAcyx.js";import{I as v}from"./input-FlGx13Sa.js";import{L as y}from"./label-CXsnonyz.js";import{a as T}from"./avatars-BFG5fSve.js";import{M as Y,a as Z}from"./MasterPinDialog-xdKhabfx.js";import{M as _}from"./masterPinService-B5aWu8_y.js";import{S as O}from"./shield-CJ3ncFGX.js";import{S as ee}from"./square-pen-BMhKZVnc.js";import{A as se}from"./arrow-left-D_1leYx7.js";import{U as ae}from"./user-BkCoOUvk.js";import{S as te}from"./save-D9aCvDLy.js";import{S as $}from"./share-2-DFDPvhQI.js";import{C as re}from"./copy-CqFk3cHu.js";import{C as P}from"./crown-BRDWB9A0.js";import{R as le}from"./refresh-cw-Bbja-0cE.js";import"./dialog-acJNJg8D.js";import"./Combination-DItV7TN9.js";import"./eye-CgXHMgEb.js";import"./circle-alert-BxQc2VaO.js";import"./lock-D_wmU4kn.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=G("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),ne=({selectedAvatarId:d,onAvatarSelect:n,className:r=""})=>{const[s,i]=x.useState(!1),h=T.find(t=>t.id===d);return e.jsxs("div",{className:`relative ${r}`,children:[e.jsx("button",{onClick:()=>i(!s),className:"w-20 h-20 rounded-full border-4 border-blue-500 hover:border-blue-600 transition-colors duration-200 bg-white shadow-lg overflow-hidden",type:"button",children:h?e.jsx("div",{className:"w-full h-full",children:h.component}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:"اختر صورة البروفيل"}),s&&e.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 min-w-max",children:[e.jsx("div",{className:"grid grid-cols-5 gap-3",children:T.map(t=>e.jsx("button",{onClick:()=>{n(t.id),i(!1)},className:`w-16 h-16 rounded-full border-2 transition-all duration-200 hover:scale-105 overflow-hidden ${d===t.id?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-blue-400"}`,type:"button",title:t.name,children:e.jsx("div",{className:"w-full h-full",children:t.component})},t.id))}),e.jsx("button",{onClick:()=>i(!1),className:"mt-3 w-full py-2 text-sm text-gray-500 hover:text-gray-700 transition-colors",type:"button",children:"إغلاق"})]}),s&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1)})]})},ie=({userId:d})=>{const[n,r]=x.useState(!1),[s,i]=x.useState("create"),{toast:h}=A(),t=_.hasMasterPin(),a=()=>{i(t?"change":"create"),r(!0)},p=()=>{r(!1),h({title:"تم بنجاح",description:t?"تم تغيير الرقم السري الرئيسي":"تم إنشاء الرقم السري الرئيسي"})},g=()=>{r(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:a,className:"flex items-center gap-2 text-sm",children:[e.jsx(O,{className:"h-4 w-4"}),t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4"}),"تغيير الرقم السري الرئيسي"]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4"}),"إنشاء رقم سري رئيسي"]})]}),e.jsx(Y,{open:n,onOpenChange:r,mode:s,onSuccess:p,onCancel:g})]})},ze=()=>{const d=J(),{toast:n}=A(),{user:r,profile:s,updateUserProfile:i,updateAvatarId:h,refreshProfile:t,userSubscription:a,isSubscriptionActive:p,checkSubscriptionStatus:g}=K(),{fontSize:w,setFontSize:C,isMobile:L}=Q(),[o,M]=x.useState({fullName:(s==null?void 0:s.fullName)||"",phone:(s==null?void 0:s.phone)||"",avatarId:(s==null?void 0:s.avatarId)||""}),[k,D]=x.useState(!1),[S,z]=x.useState(!1);x.useEffect(()=>{(async()=>{try{await g(),console.log("تم تحديث بيانات الاشتراك عند تحميل صفحة البروفايل")}catch(m){console.error("خطأ في تحديث بيانات الاشتراك:",m)}})()},[g]);const I=l=>{const{name:m,value:q}=l.target;M(H=>({...H,[m]:q}))},E=l=>{M(m=>({...m,avatarId:l}))},B=async l=>{l.preventDefault(),D(!0);try{await i({fullName:o.fullName,phone:o.phone}),o.avatarId!==(s==null?void 0:s.avatarId)&&await h(o.avatarId),await t(),n({title:"تم التحديث بنجاح",description:"تم حفظ إعدادات البروفيل بنجاح"}),setTimeout(()=>{d(-1)},500)}catch(m){console.error("Error updating profile:",m),n({title:"خطأ في التحديث",description:"حدث خطأ أثناء حفظ الإعدادات",variant:"destructive"})}finally{D(!1)}},U=async()=>{z(!0);try{await t(),await g(),console.log("تم تحديث بيانات الاشتراك يدوياً:",{userSubscription:a,isSubscriptionActive:p}),n({title:"تم تحديث بيانات الاشتراك",description:"تم تحديث معلومات اشتراكك بنجاح"})}catch(l){console.error("Error refreshing subscription:",l),n({title:"خطأ في التحديث",description:"حدث خطأ أثناء تحديث بيانات الاشتراك",variant:"destructive"})}finally{z(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>d(-1),className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"العودة"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"إعدادات البروفيل"})]}),e.jsxs(j,{className:"shadow-lg mb-6",children:[e.jsx(f,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"تحديث بيانات البروفيل"]})}),e.jsx(N,{children:e.jsxs("form",{onSubmit:B,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{children:"صورة البروفيل"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ne,{selectedAvatarId:o.avatarId,onAvatarSelect:E})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"fullName",children:"الاسم الكامل"}),e.jsx(v,{id:"fullName",name:"fullName",type:"text",value:o.fullName,onChange:I,placeholder:"أدخل اسمك الكامل",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"phone",children:"رقم الهاتف"}),e.jsx(v,{id:"phone",name:"phone",type:"tel",value:o.phone,onChange:I,placeholder:"أدخل رقم هاتفك",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"email",children:"البريد الإلكتروني"}),e.jsx(v,{id:"email",name:"email",type:"email",value:(r==null?void 0:r.email)||"",readOnly:!0,placeholder:"البريد المرتبط بحسابك",className:"text-right"})]}),e.jsx(c,{type:"submit",disabled:k,className:"w-full h-12 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium transition-all duration-300",children:k?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري الحفظ..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"حفظ التغييرات"]})})]})})]}),e.jsxs(j,{className:"shadow-lg mb-6",children:[e.jsx(f,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"رابط الإحالة الخاص بك"]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"شارك هذا الرابط مع الأصدقاء للصول على مكافآت عند تسجيلهم"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg border",children:[e.jsx(v,{value:`${window.location.origin}/register?ref=${(s==null?void 0:s.referralCode)||""}`,readOnly:!0,className:"flex-1 bg-transparent border-none text-sm"}),e.jsxs(c,{type:"button",variant:"outline",size:"sm",onClick:()=>{const l=`${window.location.origin}/register?ref=${(s==null?void 0:s.referralCode)||""}`;navigator.clipboard.writeText(l),n({title:"تم النسخ",description:"تم نسخ رابط الإحالة إلى الحافظة"})},className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"نسخ"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"رمز الإحالة الخاص بك:"}),e.jsx("span",{className:"text-blue-800 font-bold text-lg",children:(s==null?void 0:s.referralCode)||"غير متوفر"})]}),e.jsxs(c,{onClick:()=>d("/referrals"),variant:"outline",className:"w-full flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"عرض الإحالات والمكافآت"]})]})})]}),e.jsxs(j,{className:"shadow-lg mb-6",children:[e.jsx(f,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"إدارة الأرقام السرية"]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"تغيير الأرقام السرية"}),e.jsx("p",{className:"text-sm text-gray-600",children:"إدارة أرقامك السرية للنظام والمحفظة والأرباح"})]}),e.jsx(ie,{})]})})]}),L&&e.jsxs(j,{className:"shadow-lg mb-6",children:[e.jsx(f,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"حجم الخط"]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"تخصيص حجم الخط"}),e.jsx("p",{className:"text-sm text-gray-600",children:"اختر حجم الخط المناسب لك في وضع الموبايل"})]}),e.jsx("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>C("small"),className:`flex items-center gap-2 ${w==="small"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(Z,{className:"h-4 w-4"}),"صغير"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>C("medium"),className:`flex items-center gap-2 ${w==="medium"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(F,{className:"h-4 w-4"}),"متوسط"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>C("large"),className:`flex items-center gap-2 ${w==="large"?"bg-blue-100 border-blue-300 text-blue-700":""}`,children:[e.jsx(R,{className:"h-4 w-4"}),"كبير"]})]})}),e.jsx("div",{className:"text-sm text-gray-500 bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsx("p",{children:"💡 هذه الميزة تعمل في وضع الموبايل فقط وتؤثر على جميع النصوص في الموقع مع الحفاظ على تناسق الأيقونات"})})]})})]}),e.jsxs(j,{className:"shadow-lg",children:[e.jsx(f,{children:e.jsxs(b,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-yellow-500"}),"معلومات الاشتراك"]}),e.jsxs(c,{onClick:U,disabled:S,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(le,{className:`w-4 h-4 ${S?"animate-spin":""}`}),S?"جاري التحديث...":"تحديث"]})]})}),e.jsx(N,{children:p&&(a!=null&&a.subscription)?e.jsx("div",{children:e.jsxs("div",{className:"p-6 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"حالة الاشتراك"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-green-100 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-700 font-medium text-sm",children:"نشط"})]})]}),e.jsx("div",{className:"mb-4 p-4 bg-white/70 rounded-lg border border-green-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"نوع الباقة:"}),e.jsx("span",{className:`font-bold text-lg ${V(a.subscription)}`,children:W(a.subscription.planType)})]})}),e.jsxs("div",{className:"text-lg font-medium text-gray-700 leading-relaxed",children:[a.subscription.planType==="monthly"&&e.jsxs("p",{children:["اشتراكك الشهري يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.endDate)})]}),a.subscription.planType==="quarterly"&&e.jsxs("p",{children:["اشتراكك ربع السنوي يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.endDate)})]}),a.subscription.planType==="yearly"&&e.jsxs("p",{children:["اشتراكك السنوي يبدأ يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.startDate)})," وينتهي يوم ",e.jsx("span",{className:"font-bold text-green-600",children:u(a.subscription.endDate)})]}),a.subscription.planType==="lifetime"&&e.jsx("p",{className:"text-yellow-600 font-bold",children:"🎉 اشتراكك مدى الحياة - لا ينتهي أبداً"})]}),p&&a.subscription.planType!=="lifetime"&&a.subscription.planType!=="zero"&&e.jsx("div",{className:"mt-4 p-3 bg-white/50 rounded-lg border border-green-100",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["متبقي ",e.jsx("span",{className:"font-semibold text-green-600",children:X(a.subscription)})," يوم على انتهاء الاشتراك"]})})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"p-6 rounded-lg bg-gradient-to-r from-red-50 to-orange-50 border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-6 w-6 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"حالة الاشتراك"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-red-100 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-red-700 font-medium text-sm",children:"غير نشط"})]})]}),e.jsx("div",{className:"mb-4 p-4 bg-white/70 rounded-lg border border-red-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"نوع الباقة:"}),e.jsx("span",{className:"font-bold text-lg text-gray-500",children:"لا يوجد اشتراك"})]})}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"لا يوجد اشتراك مفعل"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"تواصل مع الإدارة لتفعيل اشتراكك"})]})})})]})]})})};export{ze as default};
