import{r,u as v,a as b,j as e,L as u,i,e as C,t as L,k as S,g as k,v as x}from"./index-DrngOFvF.js";import{I as p}from"./input-2iLObn1n.js";import{L as h}from"./label-CsupWXQj.js";import{C as E,a as P,b as A,c as I,d as D}from"./card-nbmFm-Ng.js";import{S as F}from"./shield-DD6WB2DA.js";import{M as q}from"./mail-Dz8Pedpx.js";import{L as M}from"./lock-CV5wKfS7.js";import{E as R,a as T}from"./eye-BrdmrTma.js";import{A as H}from"./arrow-right-DIAaQnFa.js";const W=()=>{const[l,f]=r.useState(""),[c,j]=r.useState(""),[n,g]=r.useState(!1),[o,d]=r.useState(!1),{signIn:N}=v(),w=b(),y=async a=>{var m;if(a.preventDefault(),!l||!c){i.error("يرجى إدخال البريد الإلكتروني وكلمة المرور");return}d(!0);try{const{error:s}=await N(l,c);if(s){const t=(s==null?void 0:s.code)==="auth/invalid-credential"?"البريد الإلكتروني أو كلمة المرور غير صحيحة":(s==null?void 0:s.message)||"حدث خطأ أثناء تسجيل الدخول";i.error(t);return}try{const t=(m=C.currentUser)==null?void 0:m.uid;t&&await L(S(k,"users",t),{branchPackage:{requested:!0,status:"pending",requestedAt:x()},updatedAt:x()},{merge:!0})}catch(t){console.warn("تعذر وسم المستخدم كباقة فروع:",t)}i.success("تم تسجيل الدخول بنجاح"),w("/cpanel")}catch(s){i.error((s==null?void 0:s.message)||"فشل تسجيل الدخول، حاول مرة أخرى")}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen bg-background px-4 py-8 flex items-center justify-center",children:e.jsxs(E,{className:"w-full max-w-md",children:[e.jsxs(P,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-6 h-6"}),e.jsx(A,{children:"تسجيل دخول لوحة التحكم"})]}),e.jsx(I,{children:"ادخل باستخدام بريدك الإلكتروني وكلمة المرور"})]}),e.jsx(D,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email",children:"البريد الإلكتروني"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),e.jsx(p,{id:"email",type:"email",value:l,onChange:a=>f(a.target.value),placeholder:"example@mail.com",className:"pr-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"password",children:"كلمة المرور"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),e.jsx(p,{id:"password",type:n?"text":"password",value:c,onChange:a=>j(a.target.value),placeholder:"••••••••",className:"pr-10"}),e.jsx("button",{type:"button",onClick:()=>g(a=>!a),className:"absolute left-3 top-2.5 text-muted-foreground","aria-label":n?"إخفاء كلمة المرور":"إظهار كلمة المرور",children:n?e.jsx(R,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:o,className:"w-full inline-flex items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 text-white hover:opacity-90 disabled:opacity-60",children:o?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"جاري تسجيل الدخول..."]}):e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(H,{className:"w-5 h-5 ml-2"}),"تسجيل الدخول"]})}),e.jsxs("div",{className:"mt-4 text-center space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"نسيت كلمة المرور؟"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(u,{to:"/user/forgot-password",className:"text-primary text-sm",children:"إعادة تعيين كلمة المرور"}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx(u,{to:"/auth?mode=signup",className:"text-primary text-sm",children:"إنشاء حساب جديد"})]})]})]})})]})})};export{W as default};
