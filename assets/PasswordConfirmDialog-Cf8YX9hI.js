import{d as w,r as n,j as s,e as N,O as v,Q as D}from"./index--8DkHjcr.js";import{D as y,a as C,b,c as E,d as L,e as P}from"./dialog-CduiP_68.js";import{I as k}from"./input-qTLVQ8M2.js";import{B as x}from"./button-BjxghIgB.js";import{L as I}from"./lock-CqbJrQAS.js";const q=({open:h,onOpenChange:t,title:u="تأكيد كلمة المرور",description:f="أدخل كلمة مرور تسجيل الدخول للمتابعة",onSuccess:p})=>{const{toast:g}=w(),[i,o]=n.useState(""),[c,r]=n.useState(!1),[d,a]=n.useState(null),j=async()=>{a(null);try{const e=N.currentUser;if(!e||!e.email){a("لا يوجد مستخدم مسجل حالياً. يرجى تسجيل الدخول أولاً.");return}r(!0);const l=v.credential(e.email,i);await D(e,l),r(!1),o(""),g({title:"تم التأكيد",description:"تم التحقق من كلمة المرور بنجاح"}),p(),t&&t(!1)}catch(e){console.error("إعادة التحقق بكلمة المرور فشلت:",e),r(!1);const l=(e==null?void 0:e.code)||"";a(l==="auth/wrong-password"?"كلمة المرور غير صحيحة. حاول مرة أخرى.":l==="auth/too-many-requests"?"تمت محاولات كثيرة. يرجى الانتظار قليلاً ثم المحاولة.":"حدث خطأ أثناء التحقق. حاول مرة أخرى.")}},m=e=>{t&&t(e),e||(o(""),a(null),r(!1))};return s.jsx(y,{open:h,onOpenChange:m,children:s.jsxs(C,{className:"sm:max-w-[400px]",children:[s.jsxs(b,{children:[s.jsx(E,{className:"text-right",children:u}),s.jsx(L,{className:"text-right",children:f})]}),s.jsxs("div",{className:"grid gap-4 py-2",children:[s.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[s.jsx("label",{htmlFor:"password",className:"text-right col-span-1 text-sm",children:"كلمة المرور"}),s.jsxs("div",{className:"col-span-3 relative",children:[s.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(k,{id:"password",type:"password",value:i,onChange:e=>o(e.target.value),placeholder:"نفس كلمة مرور تسجيل الدخول",autoComplete:"off"})]})]}),d&&s.jsx("div",{className:"text-red-600 text-xs text-right",children:d})]}),s.jsxs(P,{className:"flex justify-end gap-2",children:[s.jsx(x,{variant:"outline",onClick:()=>m(!1),disabled:c,children:"إلغاء"}),s.jsx(x,{onClick:j,disabled:c||!i,children:c?"جاري التحقق...":"تأكيد"})]})]})})};export{q as P};
